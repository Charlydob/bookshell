<!DOCTYPE html>

<html lang="es">
<head>
<meta charset="utf-8"/>
<title>Bookshell</title>
<meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, viewport-fit=cover" name="viewport"/>
<!-- iOS PWA -->
<meta content="yes" name="mobile-web-app-capable"/>
<meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"/>
<meta content="Bookshell" name="apple-mobile-web-app-title"/>
<link href="styles/mainstyles.css" rel="stylesheet"/>
<link href="styles/mainpage.css" rel="stylesheet"/><link href="styles/dashboard.css" rel="stylesheet"/>
<link href="styles/videos.css" rel="stylesheet"/>
<link href="styles/recipes.css" rel="stylesheet"/>
<link href="styles/habits.css" rel="stylesheet"/>
<link href="styles/games.css" rel="stylesheet"/>
<link href="styles/media.css" rel="stylesheet"/>
<link href="styles/world.css" rel="stylesheet"/>
<link href="styles/gym.css" rel="stylesheet"/>
<link href="manifest.webmanifest" rel="manifest"/>
<link href="icons/favicon.ico" rel="icon"/>
<link href="icons/favicon-32.png" rel="icon" sizes="32x32" type="image/png"/>
<link href="icons/favicon-16.png" rel="icon" sizes="16x16" type="image/png"/>
<link href="icons/icon-512.png" rel="apple-touch-icon" sizes="180x180"/>
<link href="https://cdn.jsdelivr.net/npm/quill@1.3.7/dist/quill.snow.css" rel="stylesheet"/>
<script src="https://cdn.jsdelivr.net/npm/echarts@5/dist/echarts.min.js"></script><script src="https://cdn.jsdelivr.net/npm/echarts-gl@2/dist/echarts-gl.min.js"></script>

<style>
  /* Hard guarantee: solo una vista visible (evita que todo aparezca a la vez si falla JS/CSS) */
  .view{display:none !important;}
  .view.view-active{display:block !important;}
</style>

</head>
<body>
<div class="app-shell">
<header class="app-header">
<div class="header-title"></div>
</header>
<main class="app-main">
<!-- Vista LIBROS -->
<section class="view view-active" id="view-main">
<div class="dash-header">
<div>
<div class="dash-title">Hoy</div>
<div class="dash-subtitle">Tu resumen, sin rodeos.</div>
</div>
</div>
<div class="dash-grid">
<div class="dash-card">
<div class="dash-card-inner">
<div class="dash-card-head">
<div class="dash-card-title">Tiempo por h√°bito</div>
<div class="dash-actions">
<button class="dash-btn primary" id="dash-habit-session" type="button">Empezar sesi√≥n</button>
<button class="dash-btn" id="dash-habit-open" type="button">Abrir H√°bitos</button>
</div>
</div>
<div aria-label="Rango" class="dash-chiprow" id="dash-range"></div>
<div class="dash-donut-wrap">
<div class="dash-donut" id="dash-donut"></div>
<div aria-label="Unidad de tiempo" class="dash-unit" id="dash-unit"></div>
</div>
<details class="dash-accordion">
<summary>Desglose por h√°bito</summary>
<div class="dash-legend" id="dash-legend"></div>
</details>
</div>
</div>
<div class="dash-card dash-shelf-card">
<div class="dash-card-inner">
<div class="dash-card-head">
<div class="dash-card-title">En marcha</div>
<div class="dash-actions">
<button class="dash-btn" id="dash-shelf-open-books" type="button">Libros</button>
<button class="dash-btn" id="dash-shelf-open-recipes" type="button">Recetas</button>
</div>
</div>
<div class="dash-shelf">
<div class="dash-shelf-side">
<div class="dash-shelf-label">√öltimo libro</div>
<div class="dash-shelf-slot" id="dash-shelf-book"></div>
</div>
<div aria-hidden="true" class="dash-shelf-pillar"></div>
<div class="dash-shelf-side">
<div class="dash-shelf-label">Receta</div>
<div class="dash-shelf-slot" id="dash-shelf-recipe"></div>
</div>
<div aria-hidden="true" class="dash-shelf-plank"></div>
</div>
</div>
</div>
</div>
<div class="dash-card">
<div class="dash-card-inner">
<div class="dash-card-head">
<div class="dash-card-title">√öltimo v√≠deo</div>
<div class="dash-actions">
<button class="dash-btn" id="dash-video-open" type="button">Editar</button>
</div>
</div>
<div class="dash-row">
<div class="dash-kpi">
<div class="kpi-value" id="dash-video-title">‚Äî</div>
<div class="kpi-label" id="dash-video-meta">‚Äî</div>
</div>
<div class="dash-actions">
<button class="dash-btn primary" id="dash-video-timer" type="button">Empezar cron√≥metro</button>
</div>
</div>
</div>
</div>

<div class="dash-card dash-map-card">
<div class="dash-card-inner">
<div class="dash-card-head">
<div class="dash-card-title">Mapa</div>
<div class="dash-actions">
<select class="dash-map-select" id="dash-map-select" aria-label="Elegir mapa">
<option value="media">Pantalla</option>
<option value="books">Libros</option>
<option value="recipes">Recetas</option>
<option value="world">Mundo</option></select>
</div>
</div>
<div class="dash-map-host" id="dash-map-host">
<div class="dash-map-empty" id="dash-map-empty" style="display:none;">No hay mapa a√∫n. Abre esa pesta√±a una vez para inicializarlo.</div>
</div>

<div class="dash-map-breakdown-host" id="dash-map-breakdown-host">
  <div class="dash-map-breakdown-empty" id="dash-map-breakdown-empty" style="display:none">No hay desglose a√∫n.</div>
</div>
</div>
</div>
</section></main></div>

<section class="view" id="view-books">
<!-- STATS + CALENDARIO DE LIBROS (ANTES ESTABA EN view-stats) -->
<div class="stats-wrapper">
<div class="stats-cards">
<div class="stat-card">
<div class="stat-label">Racha actual</div>
<div class="stat-value" id="stat-streak-current">0</div>
</div>
<div class="stat-card">
<div class="stat-label">Mejor racha</div>
<div class="stat-value" id="stat-streak-best">0</div>
</div>
<div class="stat-card">
<div class="stat-label">P√°ginas hoy</div>
<div class="stat-value" id="stat-today-pages">0</div>
</div>
<div class="stat-card">
<div class="stat-label">P√°ginas totales</div>
<div class="stat-value" id="stat-pages-total">0</div>
</div>
<div class="stat-card stat-card-clickable" id="stat-books-read-card">
<div class="stat-label stat-label-row">
<span>Libros le√≠dos</span>
<select aria-label="Rango libros le√≠dos" class="stat-range-select" id="stat-books-read-range">
<option selected="" value="total">Total</option>
<option value="month">Mes</option>
<option value="year">A√±o</option>
<option value="week">Semana</option>
</select>
</div>
<div class="stat-value" id="stat-books-read">0</div>
</div>
</div>
<div class="calendar-section">
<div class="calendar-header">
<div class="calendar-nav">
<button class="icon-btn" id="cal-prev">&lt;</button>
<div class="cal-label" id="cal-label"></div>
<button class="icon-btn" id="cal-next">&gt;</button>
</div>
<select aria-label="Vista del calendario" class="calendar-view-select" id="cal-view-mode">
<option selected="" value="month">Mes</option>
<option value="year">A√±o</option>
</select>
</div>
<div class="calendar-summary" id="calendar-summary"></div>
<div class="calendar-grid" id="calendar-grid">
<!-- Calendario por JS -->
</div>
<div class="calendar-legend">
<span class="dot dot-normal"></span> P√°ginas le√≠das
              <span class="dot dot-streak"></span> D√≠a de racha
              <span class="dot dot-finished"></span> Libro terminado
            </div>
</div>
</div>
<!-- TOOLBAR + LISTA LIBROS -->
<div class="books-toolbar">
<button class="btn primary" id="btn-add-book">+ A√±adir libro</button>
</div>
<div class="books-filters is-collapsed" id="books-filters">
<div class="books-filters-header" id="books-filters-header">
<div class="filter-row filter-search-row">
<label class="field-label" for="books-filter-search">Buscar</label>
<input autocomplete="off" class="filter-search-input" id="books-filter-search" inputmode="search" placeholder="T√≠tulo, autor, categor√≠a, idioma o siglo" type="search"/>
</div>
<button aria-controls="books-filters-body" aria-expanded="false" class="filters-toggle-btn" id="books-filters-toggle" type="button">
<span class="filters-toggle-text">Mostrar filtros</span>
<span aria-hidden="true" class="filters-toggle-icon">‚åÑ</span>
</button>
</div>
<div class="books-filters-body" id="books-filters-body">
<div class="filter-row">
<div class="filter-label">Filtros r√°pidos</div>
<div aria-label="Filtros din√°micos" class="filter-chip-groups" id="books-filter-chips"></div>
</div>
<div class="filter-row filter-toggles">
<label class="toggle-pill">
<input id="books-filter-pending" type="checkbox"/>
<span>Solo pendientes</span>
</label>
<label class="toggle-pill">
<input id="books-filter-finished" type="checkbox"/>
<span>Solo terminados</span>
</label>
</div>
</div>
</div>
<details class="books-watchlist" id="books-watchlist" style="display:none;">
<summary class="watchlist-summary">
<div>
<div class="watchlist-title">Watchlist</div>
<div class="watchlist-subtitle"></div>
</div>
<div class="watchlist-summary-meta">
<span class="watchlist-count" id="books-watchlist-count">0</span>
<span aria-hidden="true" class="watchlist-caret">‚åÑ</span>
</div>
</summary>
<div class="watchlist-body">
<div class="watchlist-empty" id="books-watchlist-empty" style="display:none;">
              No tienes libros pendientes ahora mismo.
            </div>
<div class="watchlist-list" id="books-watchlist-list"></div>
</div>
</details>
<div class="books-list" id="books-list">
<!-- Se rellenan las tarjetas por JS -->
</div>
<div class="empty-state" id="books-filter-empty" style="display:none;">
          No hay libros que coincidan con los filtros.
        </div>
<details class="books-finished" id="books-finished-section" style="display:none;">
<summary class="books-finished-summary">
<span>Terminados</span>
<span class="books-finished-count" id="books-finished-count">0</span>
</summary>
<div class="books-shelf-toolbar">
<label class="field-label shelf-search-label" for="books-shelf-search">Buscar en la estanter√≠a</label>
<input class="shelf-search-input" id="books-shelf-search" placeholder="T√≠tulo, autor, idioma, categor√≠a..." type="search"/>
<div class="books-shelf-results" id="books-shelf-results"></div>
</div>
<div class="books-shelf-empty" id="books-shelf-empty" style="display:none;">
    No hay libros que coincidan con la b√∫squeda.
  </div>
<div class="books-list-finished" id="books-list-finished"></div>
</details>
<section class="geo-section" id="books-geo-section" style="display:none;">
<div class="geo-card">
<div class="geo-header">
<div>
<div class="geo-title">Mapa de libros</div>
<div class="geo-subtitle">Intensidad seg√∫n n√∫mero de libros</div>
</div>
</div>
<div class="geo-map" id="books-world-map"></div>
<details aria-label="Listado de pa√≠ses (libros)" class="geo-list" id="books-country-panel">
<summary class="geo-list-summary">Pa√≠ses y n√∫mero de libros</summary>
<div class="geo-list-body" id="books-country-list"></div>
</details>
</div>
</section>
<section class="books-charts" id="books-charts-section" style="display:none;">
<div class="chart-card">
<div class="chart-card-header">
<div class="chart-card-title" id="books-chart-title">Categor√≠a</div>
<label class="chart-selector" for="books-chart-selector">
<span>Ver por</span>
<select class="chart-selector-input" id="books-chart-selector">
<option selected="" value="genre">Categor√≠a</option>
<option value="author">Autor</option>
<option value="language">Idioma</option>
<option value="century">Siglo</option>
</select>
</label>
</div>
<div class="donut-host" id="chart-active"></div>
</div>
</section>
<div class="empty-state" id="books-empty">
          A√∫n no has a√±adido ning√∫n libro.
        </div>
</section>
<!-- Vista V√çDEOS -->
<section class="view" id="view-videos">
<div class="videos-wrapper">
<!-- STATS -->
<div class="video-stats-cards">
<div class="video-stat-card">
<div class="video-stat-label">V√≠deos publicados</div>
<div class="video-stat-value" id="video-stat-count">0</div>
</div>
<div class="video-stat-card">
<div class="video-stat-label">Racha d√≠as</div>
<div class="video-stat-value" id="video-stat-streak">0</div>
</div>
<div class="video-stat-card">
<div class="video-stat-label">Palabras totales</div>
<div class="video-stat-value" id="video-stat-words">0</div>
</div>
<div class="video-stat-card">
<div class="video-stat-label">Ideas creadas</div>
<div class="video-stat-value" id="video-stat-time">0</div>
</div>
</div>
<!-- CALENDARIO -->
<div class="video-calendar-section">
<div class="video-calendar-header">
<div class="video-calendar-nav">
<button class="icon-btn" id="video-cal-prev">&lt;</button>
<div class="video-cal-label" id="video-cal-label"></div>
<button class="icon-btn" id="video-cal-next">&gt;</button>
</div>
<select aria-label="Vista del calendario de v√≠deos" class="calendar-view-select" id="video-cal-view-mode">
<option selected="" value="month">Mes</option>
<option value="year">A√±o</option>
</select>
</div>
<div class="calendar-summary" id="video-calendar-summary"></div>
<div class="video-calendar-grid" id="video-calendar-grid">
<!-- Rellenado por JS -->
</div>
<div class="video-calendar-legend">
<span class="video-dot video-dot-work"></span> Trabajo ese d√≠a
              <span class="video-dot video-dot-streak"></span> D√≠a en racha
              <span class="video-dot video-dot-publish"></span> Fecha propuesta de publicaci√≥n
            </div>
</div>
<!-- TOOLBAR + LISTA -->
<div class="videos-toolbar">
<button class="btn primary" id="btn-add-video">+ A√±adir v√≠deo</button>
<button class="btn" id="btn-add-idea">+ Idea</button>
<button class="btn" id="btn-open-links">Links</button>
</div>
<div class="videos-list" id="videos-list">
<!-- Tarjetas de v√≠deos por JS -->
</div>
<div class="videos-empty" id="videos-empty">
            A√∫n no has a√±adido ning√∫n v√≠deo.
          </div>
</div>
</section>
<section class="view" id="view-video-script">
<div class="video-script-shell">
<div class="video-script-topbar">
<button class="icon-btn" id="video-script-back" type="button">‚Üê</button>
<div class="video-script-heading">
<div class="video-script-title" id="video-script-title">T√≠tulo del guion</div>
<div class="video-script-subtitle" id="video-script-subtitle">Guion</div>
</div>
<div class="video-script-actions">
<button class="btn ghost btn-compact" id="video-script-teleprompter" type="button">Teleprompter</button>
</div>
</div>
<div class="video-script-count-header" id="video-script-count-header">
<div class="video-script-count-badge" id="video-script-count-badge">Palabras: 0 ¬∑ Progreso: 0%</div>
<button class="btn ghost" id="video-script-count-toggle" type="button">‚öôÔ∏é Conteo</button>
<button class="btn ghost btn-compact" id="video-script-insert-inline" type="button" title="Insertar recurso" aria-label="Insertar recurso">üìé</button>
</div>
<details class="video-script-meta" id="video-script-meta">
<summary class="video-script-meta-summary">Detalles del guion</summary>
<div class="video-script-meta-grid">
<div class="video-script-meta-block">
<div class="video-script-meta-label">Duraci√≥n estimada</div>
<div class="video-script-meta-value" id="video-script-duration">0 min</div>
</div>
<label class="video-script-ppm">
<span>PPM</span>
<input id="video-script-ppm" inputmode="numeric" min="60" type="number" value="150"/>
</label>
</div>
</details>

  <div class="video-script-toolbar-floating">
      <div class="video-script-toolbar" id="video-script-toolbar">
        <div class="video-script-toolbar-main">
          <button type="button" class="ql-bold" aria-label="Negrita">B</button>
          <button type="button" class="ql-italic" aria-label="Cursiva">I</button>
          <button type="button" class="ql-underline" aria-label="Subrayado">U</button>
          <button type="button" class="ql-header" value="1" aria-label="Heading">H</button>
          <button type="button" class="ql-list" value="bullet" aria-label="Lista">‚Ä¢</button>
          <button type="button" class="ql-link" aria-label="Link">üîó</button>
          <button type="button" class="ql-background" value="yellow" aria-label="Highlight">‚ú¶</button>
          <button type="button" class="ql-undo" aria-label="Deshacer">‚Ü∂</button>
          <button type="button" class="ql-redo" aria-label="Rehacer">‚Ü∑</button>
          <button class="video-toolbar-more" id="video-toolbar-more-toggle" type="button">‚ãØ</button>
        </div>
        <div class="video-script-toolbar-more-menu" id="video-toolbar-more-menu" aria-hidden="true">
          <button type="button" class="ql-list" value="ordered">Lista num</button>
          <button type="button" class="ql-header" value="2">H2</button>
          <button type="button" class="ql-header" value="3">H3</button>
          <button type="button" class="ql-blockquote">Cita</button>
          <button type="button" class="ql-clean">Limpiar</button>
        </div>
      </div>
  </div>


<div class="video-script-editor" id="video-script-editor"></div>
<button class="btn primary video-annotate-fab hidden" id="video-annotate-fab" type="button">Anotar</button>
<details class="lista-anotaciones">
  <summary>Anotaciones</summary>
      <div class="lista-anotaciones" id="video-script-annotations"> <!-- Lista de anotaciones por JS --> 
        <div class="video-inline-annotation-toggle hidden" id="video-inline-annotation-toggle">
        <div class="video-inline-annotation-title">Anotaci√≥n inline (#...#)</div>
        <div class="video-inline-annotation-text" id="video-inline-annotation-text">‚Äî</div>
        <label class="video-inline-annotation-switch">
        <span>Cuenta para palabras</span>
        <input id="video-inline-annotation-checkbox" type="checkbox" />
        </label>
        </div>
    </div>
</details>
<div class="video-annotation-popup hidden" id="video-annotation-popup">
<div class="video-annotation-popup-title" id="video-annotation-title">Nueva anotaci√≥n</div>
<div class="video-annotation-selection">
<span class="video-annotation-selection-label">Texto seleccionado</span>
<div class="video-annotation-selection-value" id="video-annotation-selection">‚Äî</div>
</div>
<textarea id="video-annotation-text" placeholder="Escribe tu anotaci√≥n..." rows="3"></textarea>
<div class="video-annotation-actions">
<button class="btn ghost" id="video-annotation-cancel" type="button">Cerrar</button>
<button class="btn ghost" id="video-annotation-delete" type="button">Borrar</button>
<button class="btn primary" id="video-annotation-save" type="button">Guardar</button>
</div>
</div>
<div class="video-sheet-backdrop" id="video-count-sheet-backdrop" aria-hidden="true">
<div class="video-bottom-sheet" id="video-count-sheet">
<div class="video-sheet-handle"></div>
<div class="video-sheet-header">
<div class="video-sheet-title">Conteo</div>
<button class="btn ghost" id="video-count-sheet-close" type="button">Listo</button>
</div>
<div class="video-script-count-toggles" id="video-script-count-toggles"></div>
<div class="video-script-count-summary" id="video-script-count-summary"></div>
</div>
</div>
<div class="video-sheet-backdrop" id="video-link-picker-backdrop" aria-hidden="true">
<div class="video-bottom-sheet" id="video-link-picker">
<div class="video-sheet-handle"></div>
<div class="video-sheet-header">
<div class="video-sheet-title">Insertar recurso</div>
<button class="btn ghost" id="video-link-picker-close" type="button">Listo</button>
</div>
<div class="video-insert-type-row" id="video-insert-type-row">
<button class="btn ghost is-active" data-insert-type="link" type="button">Link</button>
<button class="btn ghost" data-insert-type="note" type="button">Nota</button>
<button class="btn ghost" data-insert-type="quote" type="button">Cita</button>
</div>
<div class="video-insert-pane" data-insert-pane="link">
<label class="field-label" for="video-link-search">Buscar link</label>
<input class="video-link-search" id="video-link-search" placeholder="Buscar por t√≠tulo, nota o URL" type="search"/>
<div class="video-link-picker-list" id="video-link-picker-list"></div>
</div>
<div class="video-insert-pane hidden" data-insert-pane="note">
<label class="field-label" for="video-insert-note-search">Buscar nota</label>
<input class="video-link-search" id="video-insert-note-search" placeholder="Buscar por texto o t√≠tulo" type="search"/>
<div class="video-link-picker-list" id="video-insert-note-list"></div>
<details class="video-insert-create-block">
<summary>Crear nueva nota</summary>
<label class="field-label" for="video-insert-note-text">Texto de la nota</label>
<textarea class="video-insert-textarea" id="video-insert-note-text" rows="4" placeholder="Escribe la nota..."></textarea>
<button class="btn primary" id="video-insert-note-confirm" type="button">Insertar nota</button>
</details>
</div>
<div class="video-insert-pane hidden" data-insert-pane="quote">
<label class="field-label" for="video-insert-quote-search">Buscar cita</label>
<input class="video-link-search" id="video-insert-quote-search" placeholder="Buscar por cita, libro o p√°gina" type="search"/>
<div class="video-link-picker-list" id="video-insert-quote-list"></div>
<details class="video-insert-create-block">
<summary>Crear nueva cita</summary>
<label class="field-label" for="video-insert-quote-book">Libro</label>
<input class="video-link-search" id="video-insert-quote-book" list="video-books-datalist" placeholder="Buscar en tu biblioteca o escribir manualmente" type="search"/>
<datalist id="video-books-datalist"></datalist>
<label class="field-label" for="video-insert-quote-page">P√°gina</label>
<input class="video-link-search" id="video-insert-quote-page" min="1" inputmode="numeric" placeholder="Ej. 42" type="number"/>
<label class="field-label" for="video-insert-quote-text">Texto de la cita</label>
<textarea class="video-insert-textarea" id="video-insert-quote-text" rows="4" placeholder="Escribe la cita..."></textarea>
<button class="btn primary" id="video-insert-quote-confirm" type="button">Insertar cita</button>
</details>
</div>
</div>
</div>
</section>
<section class="view" id="view-video-teleprompter">
<div class="video-teleprompter-shell">
<div class="video-teleprompter-topbar">
<button class="icon-btn" id="video-teleprompter-back" type="button">‚Üê</button>
<div class="video-teleprompter-title" id="video-teleprompter-title">Teleprompter</div>
</div>
<div class="video-teleprompter-controls">
<button class="btn primary" id="video-teleprompter-play" type="button">Play</button>
<label>
<span>Velocidad (PPM)</span>
<input id="video-teleprompter-speed" inputmode="numeric" min="60" type="number" value="150"/>
</label>
<label>
<span>Tama√±o</span>
<input id="video-teleprompter-size" max="64" min="18" type="range" value="32"/>
</label>
<label class="toggle-pill">
<input id="video-teleprompter-highlight" type="checkbox"/>
<span>Resaltar frase</span>
</label>
</div>
<div class="video-teleprompter-body" id="video-teleprompter-body">
<div class="video-teleprompter-content" id="video-teleprompter-content"></div>
</div>
</div>
</section>
<section class="view" id="view-video-day">
<div class="video-day-shell">
<div class="video-day-topbar">
<button class="icon-btn" id="video-day-back" type="button">‚Üê</button>
<div class="video-day-title" id="video-day-title">Resumen del d√≠a</div>
</div>
<div class="video-day-summary" id="video-day-summary"></div>
<div class="video-day-list" id="video-day-list"></div>
</div>
</section>
<section class="view" id="view-links">
<div class="video-links-shell">
<div class="video-links-topbar">
<button class="icon-btn" id="video-links-back" type="button">‚Üê</button>
<div class="video-links-title">Links y recursos</div>
<button class="btn primary" id="video-links-new" type="button">Nuevo link</button>
</div>
<div class="video-links-filters">
<label class="field-label" for="video-links-search">Buscar</label>
<input class="video-links-search" id="video-links-search" placeholder="Buscar por t√≠tulo, nota o categor√≠a" type="search"/>
<label class="field-label" for="video-links-book-filter">Filtrar por libro</label>
<select class="video-links-search" id="video-links-book-filter">
<option value="">Todos los libros</option>
<option value="__none__">Sin libro</option>
</select>
</div>
<div class="video-links-list" id="video-links-list"></div>
<div class="video-links-empty" id="video-links-empty">A√∫n no has guardado links.</div>
</div>
</section>
<section class="view" id="view-links-new">
<div class="video-links-shell">
<div class="video-links-topbar">
<button class="icon-btn" id="video-links-new-back" type="button">‚Üê</button>
<div class="video-links-title" id="video-links-new-title">Nuevo link</div>
</div>
<form class="video-links-form" id="video-links-form">
<input id="video-link-id" type="hidden"/>
<div class="video-links-card">
<div class="video-links-card-title">Guarda un recurso</div>
<div class="hint">Si pegas una URL sin https://, la normalizamos autom√°ticamente.</div>
<label class="field-label" for="video-link-url">URL</label>
<input id="video-link-url" name="url" placeholder="https://..." type="url"/>
<label class="field-label" for="video-link-title">T√≠tulo (opcional)</label>
<input id="video-link-title" name="title" placeholder="T√≠tulo corto" type="text"/>
<label class="field-label" for="video-link-category">Categor√≠a</label>
<select id="video-link-category" name="category">
<option value="cancion">Canci√≥n</option>
<option value="visual">Visual</option>
<option value="tema">Tema</option>
<option value="bookQuote">Libro/Cita</option>
<option value="idea">Ideas/Notas</option>
<option value="otro">Otro</option>
</select>
<label class="field-label" for="video-link-note">Nota</label>
<textarea id="video-link-note" name="note" placeholder="Idea r√°pida o por qu√© sirve" rows="3"></textarea>
<div class="video-link-book-fields hidden" id="video-link-book-fields">
<label class="field-label" for="video-link-book-title">Libro</label>
<input id="video-link-book-title" list="video-books-datalist" name="bookTitle" placeholder="T√≠tulo del libro" type="search"/>
<label class="field-label" for="video-link-book-page">P√°gina (opcional)</label>
<input id="video-link-book-page" name="page" placeholder="p. 42" type="text"/>
<button class="btn ghost btn-compact" id="video-link-book-create" type="button">+ Crear libro</button>
</div>
<div class="form-error" id="video-link-error" role="alert"></div>
<div class="video-links-actions">
<button class="btn ghost" id="video-links-cancel" type="button">Cancelar</button>
<button class="btn primary" id="video-links-save" type="submit">Guardar</button>
</div>
</div>
</form>
</div>
</section>
<!-- Vista RECETAS -->
<section class="view" id="view-recipes">
<div class="recipes-wrapper">
<div class="recipes-top">
<div class="stats-cards recipes-stats-cards">
<div class="stat-card">
<div class="stat-label">Recetas</div>
<div class="stat-value" id="recipe-stat-total">0</div>
</div>
<div class="stat-card">
<div class="stat-label">Favoritas</div>
<div class="stat-value" id="recipe-stat-favorites">0</div>
</div>
<div class="stat-card">
<div class="stat-label">Saludables</div>
<div class="stat-value" id="recipe-stat-healthy">0</div>
</div>
<div class="stat-card">
<div class="stat-label">‚≠ê</div>
<div class="stat-value" id="recipe-stat-rating">0.0</div>
</div>
<div class="stat-card">
<div class="stat-label">L. Check</div>
<div class="stat-value" id="recipe-stat-laura-positive">0</div>
</div>
</div>
</div>
<div class="recipes-toolbar">
<button class="btn primary" id="btn-add-recipe">+ A√±adir receta</button>
</div>
<div class="books-filters is-collapsed" id="recipes-filters">
<div class="books-filters-header" id="recipes-filters-header">
<div class="filter-row filter-search-row">
<label class="field-label" for="recipes-filter-search">Buscar</label>
<input autocomplete="off" class="filter-search-input" id="recipes-filter-search" inputmode="search" placeholder="Nombre del plato, etiquetas o tipo de comida" type="search"/>
</div>
<button aria-controls="recipes-filters-body" aria-expanded="false" class="filters-toggle-btn" id="recipes-filters-toggle" type="button">
<span class="filters-toggle-text">Mostrar filtros</span>
<span aria-hidden="true" class="filters-toggle-icon">‚åÑ</span>
</button>
</div>
<div class="books-filters-body" id="recipes-filters-body">
<div class="filter-row">
<div class="filter-label">Filtros r√°pidos</div>
<div aria-label="Filtros din√°micos" class="filter-chip-groups" id="recipes-filter-chips"></div>
</div>
<div class="filter-row filter-toggles">
<label class="toggle-pill">
<input id="recipes-filter-favorites" type="checkbox"/>
<span>Solo favoritas</span>
</label>
<label class="toggle-pill">
<input id="recipes-filter-laura" type="checkbox"/>
<span>Con check de Laura</span>
</label>
</div>
</div>
</div>
<div class="recipes-shelf-wrapper">
<div class="recipes-shelf-toolbar">
<label class="field-label shelf-search-label" for="recipes-shelf-search">Buscar en la estanter√≠a</label>
<input class="shelf-search-input" id="recipes-shelf-search" placeholder="Nombre, tipo, etiquetas..." type="search"/>
<div class="books-shelf-results" id="recipes-shelf-results"></div>
</div>
<div class="books-shelf-empty" id="recipes-shelf-empty" style="display:none;">
              No hay recetas que coincidan con la b√∫squeda.
            </div>
<div class="books-list recipes-shelf" id="recipes-list"></div>
<details class="books-finished" id="recipes-favorites-section" style="display:none;">
<summary class="books-finished-summary">
<span>Favoritas</span>
<span class="books-finished-count" id="recipes-favorites-count">0</span>
</summary>
<div class="books-list-finished" id="recipes-list-favorites"></div>
</details>
</div>
<section class="geo-section" id="recipes-geo-section" style="display:none;">
<div class="geo-card">
<div class="geo-header">
<div>
<div class="geo-title">Mapa de recetas</div>
<div class="geo-subtitle">Intensidad seg√∫n n√∫mero de platos</div>
</div>
</div>
<div class="geo-map" id="recipes-world-map"></div>
<details aria-label="Listado de pa√≠ses (recetas)" class="geo-list" id="recipes-country-panel">
<summary class="geo-list-summary">Pa√≠ses y n√∫mero de platos</summary>
<div class="geo-list-body" id="recipes-country-list"></div>
</details>
</div>
</section>
<section class="books-charts" id="recipes-charts-section">
<div class="books-charts-grid">
<div class="chart-card">
<div class="chart-card-title">Tipo de comida</div>
<div class="donut-host" id="recipe-chart-meal"></div>
</div>
<div class="chart-card">
<div class="chart-card-title">Saludable/Insana</div>
<div class="donut-host" id="recipe-chart-health"></div>
</div>
</div>
</section>
<div class="empty-state" id="recipes-empty">
            A√∫n no has a√±adido recetas.
          </div>
</div>
</section>
<!-- Vista H√ÅBITOS -->
<section class="view" id="view-habits">
<div class="habits-wrapper">
  <header class="habits-header">
  <div class="habits-title"></div>
  </header>
<div class="habit-quick-actions habit-quick-actions-bar">
<button class="btn ghost btn-compact habit-quick-btn" id="habit-add-time">+ A√±adir tiempo</button>
<button class="btn ghost btn-compact habit-quick-btn" id="habit-fab-add">+ A√±adir h√°bito</button>
<button class="btn ghost btn-compact habit-quick-btn" id="habit-session-toggle">‚ñ∂Ô∏é Empezar sesi√≥n</button>
</div>
<div aria-label="Vistas de h√°bitos" class="habits-subtabs" role="tablist">
<button aria-selected="true" class="habit-subtab is-active" data-tab="today" role="tab">Hoy</button>
<button aria-selected="false" class="habit-subtab" data-tab="week" role="tab">Semana</button>
<button aria-selected="false" class="habit-subtab" data-tab="history" role="tab">Historial</button>
<button aria-selected="false" class="habit-subtab" data-tab="reports" role="tab">Reportes</button>
</div>
<div class="habits-views">
<div class="habits-panel is-active" data-panel="today">
<div class="habit-week-timeline" id="habit-week-timeline" aria-label="Semana actual"></div>
<div class="habit-today-search" id="habit-today-search">
  <span class="habit-search-icon" aria-hidden="true">üîç</span>
  <input autocomplete="off" class="habit-search-input" id="habit-today-search-input" inputmode="search" placeholder="Buscar h√°bito‚Ä¶" type="search"/>
  <button class="habit-search-clear" id="habit-today-search-clear" type="button" aria-label="Limpiar b√∫squeda">‚úï</button>
</div>
<div class="habit-search-empty" id="habit-today-search-empty" style="display:none;">
  <div class="habit-search-empty-text">No hay h√°bitos que coincidan</div>
  <button class="btn ghost btn-compact" id="habit-today-search-reset" type="button">Limpiar</button>
</div>
<details class="habit-accordion habit-quick-sessions" id="habit-quick-sessions" data-search-ignore="true">
  <summary>
    <div class="habit-accordion-title">Sesiones r√°pidas</div>
    <div class="habit-accordion-meta" id="habit-quick-sessions-meta">‚Äî</div>
    <div class="habit-accordion-preview" id="habit-quick-sessions-preview">Toca para a√±adir</div>
  </summary>
  <div class="habit-accordion-body">
    <div class="habit-quick-sessions-controls">
      <select id="habit-quick-sessions-select"></select>
      <button class="btn ghost btn-compact" id="habit-quick-sessions-add" type="button">A√±adir</button>
    </div>
    <div class="habit-quick-sessions-row" id="habit-quick-sessions-row"></div>
    <div class="empty-state small" id="habit-quick-sessions-empty" style="display:none;">A√±ade h√°bitos de tiempo para iniciar sesiones con un toque.</div>
  </div>
</details>
<div class="quick-counters-wrap">
  <div class="quick-counters-title">
    Contadores r√°pidos
  </div>

  <div class="quick-counters-grid" id="quick-counters-grid"></div>
</div>
<div class="habit-custom-groups" id="habit-custom-groups"></div>
<details class="habit-accordion habit-today-accordion" id="habits-today-acc-count" open>
<summary>
<div class="habit-accordion-title">Contadores</div>
<div class="habit-accordion-meta" id="habits-today-count-meta">‚Äî</div>
<div class="habit-accordion-preview" id="habits-today-count-preview">‚Äî</div>
</summary>
<div class="habit-accordion-body">
<div class="habits-subgroup">
<div class="habits-subgroup-title">Pendientes</div>
<div class="habit-card-list" id="habits-today-count-pending"></div>

<details class="habit-accordion habit-mini-group" id="habits-today-count-pending-private-wrap">
  <summary>
    <div class="habit-accordion-title">Privados</div>
    <div class="habit-accordion-meta"></div>
  </summary>
  <div class="habit-accordion-body">
    <div class="habit-card-list" id="habits-today-count-pending-private"></div>
  </div>
</details>

<details class="habit-accordion habit-mini-group" id="habits-today-count-pending-low-wrap">
  <summary>
    <div class="habit-accordion-title">Poco uso</div>
    <div class="habit-accordion-meta"></div>
  </summary>
  <div class="habit-accordion-body">
    <div class="habit-card-list" id="habits-today-count-pending-low"></div>
  </div>
</details>

<div class="empty-state small" id="habits-today-count-empty">No tienes contadores pendientes hoy.</div>
</div>
<div class="habits-subgroup">
<div class="habits-subgroup-title">Hechos</div>
<div class="habit-card-list" id="habits-today-count-done"></div>

<details class="habit-accordion habit-mini-group" id="habits-today-count-done-private-wrap">
  <summary>
    <div class="habit-accordion-title">Privados</div>
    <div class="habit-accordion-meta"></div>
  </summary>
  <div class="habit-accordion-body">
    <div class="habit-card-list" id="habits-today-count-done-private"></div>
  </div>
</details>

<details class="habit-accordion habit-mini-group" id="habits-today-count-done-low-wrap">
  <summary>
    <div class="habit-accordion-title">Poco uso</div>
    <div class="habit-accordion-meta"></div>
  </summary>
  <div class="habit-accordion-body">
    <div class="habit-card-list" id="habits-today-count-done-low"></div>
  </div>
</details>

<div class="empty-state small" id="habits-today-count-done-empty">A√∫n no has marcado ning√∫n contador hoy.</div>
</div>
</div>
</details>

<details class="habit-accordion habit-today-accordion" id="habits-today-acc-time" open>
<summary>
<div class="habit-accordion-title">Por tiempo</div>
<div class="habit-accordion-meta" id="habits-today-time-meta">‚Äî</div>
<div class="habit-accordion-preview" id="habits-today-time-preview">‚Äî</div>
</summary>
<div class="habit-accordion-body">
<div class="habits-subgroup">
<div class="habits-subgroup-title">Pendientes</div>
<div class="habit-card-list" id="habits-today-time-pending"></div>

<details class="habit-accordion habit-mini-group" id="habits-today-time-pending-private-wrap">
  <summary>
    <div class="habit-accordion-title">Privados</div>
    <div class="habit-accordion-meta"></div>
  </summary>
  <div class="habit-accordion-body">
    <div class="habit-card-list" id="habits-today-time-pending-private"></div>
  </div>
</details>

<details class="habit-accordion habit-mini-group" id="habits-today-time-pending-low-wrap">
  <summary>
    <div class="habit-accordion-title">Poco uso</div>
    <div class="habit-accordion-meta"></div>
  </summary>
  <div class="habit-accordion-body">
    <div class="habit-card-list" id="habits-today-time-pending-low"></div>
  </div>
</details>

<div class="empty-state small" id="habits-today-time-empty">No tienes h√°bitos pendientes hoy.</div>
</div>
<div class="habits-subgroup">
<div class="habits-subgroup-title">Hechos</div>
<div class="habit-card-list" id="habits-today-time-done"></div>

<details class="habit-accordion habit-mini-group" id="habits-today-time-done-private-wrap">
  <summary>
    <div class="habit-accordion-title">Privados</div>
    <div class="habit-accordion-meta"></div>
  </summary>
  <div class="habit-accordion-body">
    <div class="habit-card-list" id="habits-today-time-done-private"></div>
  </div>
</details>

<details class="habit-accordion habit-mini-group" id="habits-today-time-done-low-wrap">
  <summary>
    <div class="habit-accordion-title">Poco uso</div>
    <div class="habit-accordion-meta"></div>
  </summary>
  <div class="habit-accordion-body">
    <div class="habit-card-list" id="habits-today-time-done-low"></div>
  </div>
</details>

<div class="empty-state small" id="habits-today-time-done-empty">A√∫n no has completado ning√∫n h√°bito hoy.</div>
</div>
</div>
</details>
</div>
<div class="habits-panel" data-panel="week">
<div class="habits-week-list" id="habits-week-list"></div>
<div class="empty-state small" id="habits-week-empty">A√±ade h√°bitos para empezar tu semana.</div>
</div>
<div class="habits-panel" data-panel="history">
<div class="habit-heatmap-list" id="habits-history-list"></div>
<div class="empty-state small" id="habits-history-empty">Sin historial a√∫n.</div>
</div>
<div class="habits-panel" data-panel="reports">
<div class="habit-reports">
<div class="habit-card-head">
<div class="habit-card-title">Exportaci√≥n</div>
<button class="game-menu-btn" id="habits-export-btn" type="button">Exportar CSV</button>
</div>
<div class="habit-kpi-grid">
<div class="habit-kpi-card">
<div class="habit-kpi-label" id="habit-kpi-today-label">Hechos hoy</div>
<div class="habit-kpi-value" id="habit-kpi-today">0</div>
</div>
<div class="habit-kpi-card">
<div class="habit-kpi-label">Horas totales</div>
<div class="habit-kpi-value" id="habit-kpi-total-hours">0h</div>
<div class="habit-kpi-sub" id="habit-kpi-total-hours-range">‚Äî</div>
</div>
<div class="habit-kpi-card">
<div class="habit-kpi-label" id="habit-kpi-active-days-label">D√≠as contabilizados total</div>
<div class="habit-kpi-value" id="habit-kpi-active-days-total">0</div>
</div>
<div class="habit-kpi-card">
<div class="habit-kpi-label" id="habit-kpi-streak-label">Racha total</div>
<div class="habit-kpi-value" id="habit-kpi-streak-total">0</div>
<div class="habit-kpi-sub" id="habit-kpi-streak-total-sub">‚Äî</div>
</div>
</div>
<div class="habit-kpi-grid habit-pin-grid">
<div class="habit-kpi-card habit-pin-card">
<div class="habit-kpi-label">Seguimiento ¬∑ Contador</div>
<div class="habit-kpi-value" id="habit-pin-count-today">‚Äî</div>
<div class="habit-kpi-sub" id="habit-pin-count-range">‚Äî</div>
<label class="habit-pin-select">
<select aria-label="Elegir contador para pin 1" id="habit-pin-count-select"></select>
</label>
</div>
<div class="habit-kpi-card habit-pin-card">
<div class="habit-kpi-label">Seguimiento ¬∑ Tiempo</div>
<div class="habit-kpi-value" id="habit-pin-time-today">‚Äî</div>
<div class="habit-kpi-sub" id="habit-pin-time-range">‚Äî</div>
<label class="habit-pin-select">
<select aria-label="Elegir h√°bito de tiempo para pin 2" id="habit-pin-time-select"></select>
</label>
</div>
</div>
<div class="habit-chart-card habit-shifts-card">
<div class="habit-card-head">
<div>
<div class="habit-card-title">Turnos (Trabajo)</div>
<div class="habit-card-sub" id="habit-shifts-range-meta">Rango Mes</div>
</div>
</div>
<div class="habit-records-grid">
<div class="habit-record-card habit-record-card-ma√±anas">
<div class="habit-kpi-label">Ma√±anas</div>
<div class="habit-kpi-value" id="habit-shifts-morning">0</div>
</div>
<div class="habit-record-card habit-record-card-tardes">
<div class="habit-kpi-label">Tardes</div>
<div class="habit-kpi-value" id="habit-shifts-evening">0</div>
</div>
<div class="habit-record-card habit-record-card-libres">
<div class="habit-kpi-label">D√≠as libres</div>
<div class="habit-kpi-value" id="habit-shifts-free">0</div>
</div>
<div class="habit-record-card habit-record-card-desconocidos">
<div class="habit-kpi-label">Desconocido</div>
<div class="habit-kpi-value" id="habit-shifts-unknown">0</div>
</div>
</div>
</div>
<div class="habit-chart-card habit-records-card">
<div class="habit-card-head">
<div>
<div class="habit-card-title">R√©cords</div>
<div class="habit-card-sub" id="habit-records-sub">√öltimos 30 d√≠as</div>
</div>
<div aria-label="Rango de r√©cords" class="habit-range-toggle habit-records-range" role="group">
<button class="habit-range-btn habit-records-range-btn" data-range="week">Semana</button>
<button class="habit-range-btn habit-records-range-btn is-active" data-range="month">Mes</button>
<button class="habit-range-btn habit-records-range-btn" data-range="year">A√±o</button>
<button class="habit-range-btn habit-records-range-btn" data-range="total">Total</button>
</div>
</div>
<div class="habit-records-grid">
<div class="habit-record-card">
<div class="habit-kpi-label">Racha actual (total)</div>
<div class="habit-kpi-value" id="habit-records-current-streak">0</div>
</div>
<div class="habit-record-card">
<div class="habit-kpi-label">Mejor racha (rango)</div>
<div class="habit-kpi-value" id="habit-records-best-streak">0</div>
</div>
<div class="habit-record-card">
<div class="habit-kpi-label">Completados</div>
<div class="habit-kpi-value" id="habit-records-completed">0</div>
<div class="habit-kpi-sub" id="habit-records-completed-sub">‚Äî</div>
</div>
<div class="habit-record-card">
<div class="habit-kpi-label">% √©xito</div>
<div class="habit-kpi-value" id="habit-records-success">0%</div>
</div>
</div>
</div>
<div class="habit-chart-card habit-donut-card">
<div class="habit-card-head">
<div>
<div class="habit-card-title" id="habit-donut-title">Tiempo por h√°bito</div>
<div class="habit-card-sub" id="habit-donut-sub">Distribuci√≥n diaria</div>
</div>
<label class="habit-select habit-select-compact" for="habit-donut-group">
<span>Agrupar por</span>
<select aria-label="Agrupar por" id="habit-donut-group">
<option value="habit">H√°bito</option>
<option value="param">Par√°metro</option>
</select>
</label>
<div aria-label="Rango de tiempo" class="habit-range-toggle" role="group">
<button class="habit-range-btn" data-range="day">D√≠a</button>
<button class="habit-range-btn" data-range="week">Semana</button>
<button class="habit-range-btn" data-range="month">Mes</button>
<button class="habit-range-btn" data-range="year">A√±o</button>
<button class="habit-range-btn is-active" data-range="total">Total</button>
</div>
</div>
<div class="habit-donut-body">
<div class="habit-donut" id="habit-donut"></div>
<div class="habit-donut-center" id="habit-donut-center">
<div class="habit-donut-label">Tiempo</div>
<div class="habit-donut-total" id="habit-donut-total">0m</div>
<div class="habit-unit" id="habit-unit" aria-label="Unidad de tiempo"></div>
</div>
</div>
  <div class="empty-state small" id="habit-donut-empty" style="display:none;">
  No hay datos en este rango.
</div>

<details class="habit-donut-legend-wrap">
  <summary>Leyenda</summary>
  <div class="habit-donut-legend" id="habit-donut-legend"></div>
</details>

<div class="habit-chart-card habit-line-card" id="habit-line-card-grafico">
<div class="habit-card-head habit-line-head">
<div>
<div class="habit-card-title">Evoluci√≥n (min/d√≠a)</div>
<div class="habit-card-sub" id="habit-line-sub">√öltimos 7 d√≠as ¬∑ Total</div>
</div>
<div class="habit-line-controls">
<label class="habit-select" for="habit-evo-select">
<span>H√°bito</span>
<select aria-label="H√°bito para evoluci√≥n" id="habit-evo-select"></select>
</label>
<label class="habit-select habit-select-compact" for="habit-evo-range">
<span>Rango</span>
<select aria-label="Rango evoluci√≥n" id="habit-evo-range">
<option selected="" value="total">Total</option>
<option value="30d">30D</option>
<option value="90d">90D</option>
<option value="year">A√±o</option>
<option value="7d">7D</option>
</select>
</label>
</div>
</div>
<div class="habit-line-metrics" id="habit-line-metrics">
<div class="habit-metric">
<div class="habit-metric-label">Tiempo total (rango)</div>
<div class="habit-metric-value" id="habit-line-total">0m</div>
</div>
<div class="habit-metric">
<div class="habit-metric-label">D√≠as activos (rango)</div>
<div class="habit-metric-sub" id="habit-line-days">0</div>
</div>
</div>
<div class="habit-line-body">
<div class="habit-line-chart" id="habit-line-chart"></div>
<div class="empty-state small" id="habit-line-empty" style="display:none;">No hay datos en este rango.</div>
</div>
</div>
<details class="habit-accordion" id="habit-acc-week">
<summary>
<div class="habit-accordion-title">Top minutos (semana)</div>
<div class="habit-accordion-meta" id="habit-acc-week-meta">‚Äî</div>
</summary>
<div class="habit-accordion-body">
<div class="habit-ranking-list" id="habit-ranking-week"></div>
</div>
</details>
<details class="habit-accordion" id="habit-acc-month">
<summary>
<div class="habit-accordion-title">Top minutos (mes)</div>
<div class="habit-accordion-meta" id="habit-acc-month-meta">‚Äî</div>
</summary>
<div class="habit-accordion-body">
<div class="habit-ranking-list" id="habit-ranking-month"></div>
</div>
</details>
<div class="habit-range-toggle habit-days-range">
<button class="habit-range-btn habit-days-range-btn is-active" data-range="day">D√≠a</button>
<button class="habit-range-btn habit-days-range-btn" data-range="week">Semana</button>
<button class="habit-range-btn habit-days-range-btn" data-range="month">Mes</button>
<button class="habit-range-btn habit-days-range-btn" data-range="year">A√±o</button>
<button class="habit-range-btn habit-days-range-btn" data-range="total">Total</button>
</div>
<details class="habit-accordion" id="habit-acc-total">
<summary>
<div class="habit-accordion-title">Totales por h√°bito</div>
<div class="habit-accordion-meta" id="habit-acc-total-meta">‚Äî</div>
</summary>
<div class="habit-accordion-body">
<div class="habit-ranking-list" id="habit-totals-list"></div>
</div>
</details>
<details class="habit-accordion" id="habit-acc-counts">
<summary>
<div class="habit-accordion-title">Contadores</div>
<div class="habit-accordion-meta" id="habit-acc-counts-meta">‚Äî</div>
</summary>
<div class="habit-accordion-body">
<div class="habit-ranking-list" id="habit-counts-list"></div>
</div>
</details>
<details class="habit-accordion" id="habit-acc-days">
<summary>
<div class="habit-accordion-title">D√≠as hechos</div>
<div class="habit-accordion-meta" id="habit-acc-days-meta">‚Äî</div>
</summary>
<div class="habit-accordion-body">
<div class="habit-ranking-list" id="habit-days-list"></div>
</div>
</details>
<details class="habit-accordion" id="habit-acc-consistency">
<summary>
<div class="habit-accordion-title">Consistencia</div>
<div class="habit-accordion-meta" id="habit-acc-consistency-meta">‚Äî</div>
</summary>
<div class="habit-accordion-body">
<div class="habit-ranking-list" id="habit-ranking-consistency"></div>
</div>
</details>
</div>
</div>
</div>
</div>
<div class="habit-session-overlay hidden" id="habit-session-overlay">
<div class="habit-session-pill">
<div>
<div class="habit-session-label">Sesi√≥n en curso</div>
<div class="habit-session-time" id="habit-session-time">00:00</div>
</div>
<button class="btn danger btn-compact" id="habit-session-stop">‚èπ Parar</button>
</div>
</div>
<div class="habit-detail-overlay hidden" id="habit-detail-overlay" role="dialog" aria-modal="true" aria-hidden="true">
<div class="habit-detail-panel">
<header class="habit-detail-header">
<div class="habit-detail-head-main">
<button class="habit-detail-emoji habit-icon" id="habit-detail-emoji" type="button" aria-label="Editar h√°bito">üè∑Ô∏è</button>
<div class="habit-detail-head-text">
<div class="habit-detail-title" id="habit-detail-title">H√°bito</div>
<div class="habit-detail-sub" id="habit-detail-meta">‚Äî</div>
<div class="habit-detail-total" id="habit-detail-total">Total: ‚Äî</div>
</div>
</div>
<div class="habit-detail-head-actions">
<button class="btn ghost btn-compact" id="habit-detail-edit" type="button">Editar</button>
<button class="icon-btn" id="habit-detail-close" type="button" aria-label="Cerrar">‚úï</button>
</div>
</header>
<div class="habit-detail-body">
<div class="habit-detail-summary">
<div class="habit-detail-chip" id="habit-detail-status">Pendiente hoy</div>
<div class="habit-detail-chip" id="habit-detail-streak">üî• 0</div>
<div class="habit-detail-chip" id="habit-detail-goal">‚Äî</div>
</div>
<div class="habit-detail-actions" id="habit-detail-actions"></div>
<div aria-label="Rango de h√°bito" class="habit-range-toggle habit-detail-range" role="group">
<button class="habit-range-btn" data-range="week" type="button">Semana</button>
<button class="habit-range-btn is-active" data-range="month" type="button">Mes</button>
<button class="habit-range-btn" data-range="year" type="button">A√±o</button>
<button class="habit-range-btn" data-range="total" type="button">Total</button>
</div>
<section class="habit-detail-section">
<div class="habit-detail-section-head">
<div class="habit-detail-section-title">Calendario</div>
<div class="habit-detail-section-sub" id="habit-detail-heatmap-sub">‚Äî</div>
</div>
<div class="habit-detail-heatmap" id="habit-detail-heatmap"></div>
</section>
<section class="habit-detail-section">
<div class="habit-detail-section-head">
<div class="habit-detail-section-title">Evoluci√≥n</div>
<div class="habit-detail-section-sub" id="habit-detail-chart-sub">‚Äî</div>
</div>
<div class="habit-detail-chart-controls">
<div class="habit-range-toggle" id="habit-detail-chart-mode" role="group" aria-label="Tipo de gr√°fico">
<button class="habit-range-btn is-active" data-mode="bar" type="button">Barras</button>
<button class="habit-range-btn" data-mode="line" type="button">L√≠nea</button>
</div>
<div class="habit-range-toggle" id="habit-detail-chart-range" role="group" aria-label="Rango del gr√°fico">
<button class="habit-range-btn is-active" data-chart-range="30d" type="button">30d</button>
<button class="habit-range-btn" data-chart-range="90d" type="button">90d</button>
<button class="habit-range-btn" data-chart-range="total" type="button">Total</button>
</div>
</div>
<div class="habit-detail-chart" id="habit-detail-chart"></div>
<div class="habit-detail-chart-meta" id="habit-detail-chart-meta"></div>
</section>
<details class="habit-detail-section habit-detail-records-wrap" id="habit-detail-records-wrap">
<summary class="habit-detail-records-summary">
<div class="habit-detail-section-head">
<div class="habit-detail-section-title">Registros</div>
<div class="habit-detail-section-sub" id="habit-detail-records-sub">Ver registros</div>
</div>
<span aria-hidden="true" class="habit-detail-records-chevron">‚åÑ</span>
</summary>
<div class="habit-detail-records-body">
<div class="habit-detail-records" id="habit-detail-records"></div>
<button class="btn ghost btn-compact habit-detail-records-more hidden" id="habit-detail-records-more" type="button">Ver m√°s</button>
</div>
</details>
<section class="habit-detail-section">
<div class="habit-detail-section-head">
<div class="habit-detail-section-title">Insights</div>
<div class="habit-detail-section-sub" id="habit-detail-insights-sub">‚Äî</div>
</div>
<div class="habit-detail-insights" id="habit-detail-insights"></div>
</section>
</div>
</div>
</div>
</section>

<section class="view" id="view-games">
<div class="games-view">
<div class="games-header">
<div>
<div class="games-title">Juegos</div>
<div class="games-subtitle">Contadores por juego y modo</div>
</div>
<button class="btn primary" id="game-add-mode" type="button">+ A√±adir modo</button>
</div>
<div class="games-tabs" role="tablist" aria-label="Ventanas de juegos">
<button class="games-tab-btn is-active" id="game-tab-counters" data-games-tab="counters" role="tab" aria-selected="true" type="button">Contadores</button>
<button class="games-tab-btn" id="game-tab-stats" data-games-tab="stats" role="tab" aria-selected="false" type="button">Estad√≠sticas</button>
</div>
<section class="games-stats-card hidden" id="game-stats-card" data-games-panel="stats">
<div class="games-stats-head">
<div>
<div class="games-stats-title">Estad√≠sticas</div>
<div class="games-stats-sub" id="game-stats-sub">Global</div>
</div>
<div class="games-stats-actions">
<button class="game-menu-btn" id="games-export-btn" type="button">Exportar CSV</button>
<select id="game-stats-group-filter" class="games-stats-filter"></select>
</div>
</div>
<div class="game-ranges" id="game-stats-ranges">
<button class="game-range-btn" data-stats-range="day" type="button">D√≠a</button>
<button class="game-range-btn" data-stats-range="week" type="button">Semana</button>
<button class="game-range-btn" data-stats-range="month" type="button">Mes</button>
<button class="game-range-btn" data-stats-range="year" type="button">A√±o</button>
<button class="game-range-btn is-active" data-stats-range="total" type="button">Total</button>
</div>
<div class="games-stats-totals" id="game-stats-totals">0 partidas ¬∑ 0W / 0L / 0T</div>
<div class="games-stats-grid">
<div class="games-donut" id="game-stats-donut"></div>
<div class="games-line" id="game-stats-line"></div>
</div>
<div class="games-stats-breakdown" id="game-stats-breakdown"></div>
</section>
<div class="games-list" id="games-groups-list" data-games-panel="counters"></div>
<div class="empty-state" id="games-empty">A√∫n no tienes juegos. Crea tu primer modo.</div>
</div>
</section>

<section class="view" id="view-media">
  <div class="media-wrapper">
    <div class="media-head">
      <div class="media-head-left">
        <div class="media-title">Pantalla</div>
        <div class="media-sub"></div>
      </div>

      <div class="media-viewbar" role="group" aria-label="Vista">
        <button class="media-viewbtn is-active" data-media-view="list" type="button">Lista</button>
        <button class="media-viewbtn" data-media-view="charts" type="button">Gr√°ficos</button>
        <button class="media-viewbtn" data-media-view="map" type="button">Mapa</button>
      </div>
    </div>

    <div class="media-filters">
      <div class="media-filter-row">
        <input id="media-search" class="filter-search-input" type="search" inputmode="search"
               placeholder="Buscar t√≠tulo, g√©nero, pa√≠s, actor, director‚Ä¶" autocomplete="off" />
      </div>

      <div class="media-type-pills" id="media-type-pills" aria-label="Tipo">
        <button class="media-pill is-active" data-type="all" type="button">Todo</button>
        <button class="media-pill" data-type="movie" type="button">Pelis</button>
        <button class="media-pill" data-type="series" type="button">Series</button>
        <button class="media-pill" data-type="anime" type="button">Anime</button>
      </div>

      <div class="media-filters-slot"></div>
    </div>

    <!-- FAB (centro inferior, encima del nav) -->
    <input class="media-modal-toggle" hidden id="media-add-toggle" type="checkbox" />
    <label class="media-fab" id="media-fab-add" for="media-add-toggle" role="button" aria-label="A√±adir">Ôºã</label>

    <!-- Modal: A√±adir -->
    <div class="media-modal media-add-modal" aria-hidden="true">
      <label class="media-modal-backdrop" for="media-add-toggle" aria-label="Cerrar"></label>

      <div class="media-modal-sheet" role="dialog" aria-modal="true" aria-label="A√±adir t√≠tulo">
        <div class="media-modal-head">
          <div class="media-modal-headtext">
            <div class="media-modal-title">A√±adir t√≠tulo</div>
            <div class="media-modal-sub">Ficha r√°pida, datos s√≥lidos.</div>
          </div>
          <label class="media-modal-close" for="media-add-toggle" role="button" title="Cerrar">‚úï</label>
        </div>

        <div class="media-modal-body">
          <section class="media-modal-section">
            <div class="media-modal-section-title">Meta</div>
            <label class="media-modal-field">
              <span>T√≠tulo</span>
              <div class="media-title-row">
                <input id="media-title" class="media-input" placeholder="A√±adir t√≠tulo‚Ä¶" autocomplete="off" />
                <button class="btn ghost btn-compact" id="media-autofill-btn" type="button" disabled>Autocompletar</button>
              </div>
            </label>
            <div class="media-autocomplete-results" id="media-autofill-results" aria-live="polite"></div>

            <div class="media-modal-grid media-modal-grid--meta">
              <label class="media-modal-field">
                <span>Tipo</span>
                <select id="media-type" class="media-input">
                  <option value="movie">Peli</option>
                  <option value="series">Serie</option>
                  <option value="anime">Anime</option>
                </select>
              </label>

              <label class="media-modal-field">
                <span>A√±o</span>
                <input id="media-year" class="media-input" type="number" inputmode="numeric" placeholder="Ej: 2024" />
              </label>

              <label class="media-modal-field">
                <span>Origen</span>
                <input id="media-country" class="media-input" list="country-options" placeholder="Ej: Espa√±a" autocomplete="off" />
              </label>
            </div>
          </section>

          <section class="media-modal-section">
            <div class="media-modal-section-title">Detalles</div>

            <details class="media-modal-accordion" open>
              <summary>G√©neros</summary>
              <div class="media-modal-accordion-body">
                <input id="media-genres" class="media-input" placeholder="acci√≥n, drama‚Ä¶" autocomplete="off" />
                <div class="media-chip-preview" id="media-add-genres-preview"></div>
              </div>
            </details>

            <details class="media-modal-accordion">
              <summary>Director</summary>
              <div class="media-modal-accordion-body">
                <input id="media-director" class="media-input" placeholder="Opcional" autocomplete="off" />
              </div>
            </details>

            <details class="media-modal-accordion">
              <summary>Reparto</summary>
              <div class="media-modal-accordion-body">
                <input id="media-cast" class="media-input" placeholder="Opcional" autocomplete="off" />
                <div class="media-chip-preview" id="media-add-cast-preview"></div>
              </div>
            </details>
          </section>

          <section class="media-modal-section" id="media-add-progress-section">
            <div class="media-modal-section-title">Progreso</div>
            <div class="media-modal-grid" id="media-seasonep">
              <label class="media-modal-field">
                <span>Temporada</span>
                <input id="media-season" class="media-input" type="number" inputmode="numeric" placeholder="1" />
              </label>
              <label class="media-modal-field">
                <span>Cap√≠tulo</span>
                <input id="media-episode" class="media-input" type="number" inputmode="numeric" placeholder="1" />
              </label>
            </div>
          </section>

          <section class="media-modal-section">
            <div class="media-modal-section-title">Vistas</div>
            <div class="media-modal-toggles">
              <label class="media-check">
                <input id="media-watchlist" type="checkbox" />
                <span>Watchlist</span>
              </label>
              <label class="media-check">
                <input id="media-with-laura" type="checkbox" />
                <span>Laura</span>
              </label>
              <label class="media-check">
                <select id="media-rating" class="media-input media-input-compact">
                  <option value="0">0</option><option value="1">1</option><option value="2">2</option>
                  <option value="3">3</option><option value="4">4</option><option value="5">5</option>
                </select>
                <span>Rating</span>
              </label>
            </div>

            <div class="media-watch-row">
              <button class="btn ghost btn-compact" id="media-add-watchtoday" type="button">Visto hoy</button>
              <div class="media-watch-meta" id="media-add-watch-meta">Se guardar√° como visto hoy.</div>
            </div>
          </section>
        </div>

        <div class="media-modal-foot">
          <button class="btn ghost" id="media-add-cancel" type="button">Cancelar</button>
          <button class="btn primary" id="media-add-confirm" type="button">Guardar</button>
        </div>
      </div>
    </div>

    <!-- Charts -->
    <section class="media-chart-card" id="media-chart-card" style="display:none">
      <div class="media-chart-head">
        <div>
          <div class="media-chart-title">Distribuci√≥n</div>
          <div class="media-chart-sub" id="media-chart-sub">Top 16 (sin ‚Äúotros‚Äù).</div>
        </div>

        <label class="chart-selector" for="media-chart-selector">
          <span>Ver por</span>
          <select class="chart-selector-input" id="media-chart-selector">
            <option value="type" selected>Tipo</option>
            <option value="genre">G√©nero</option>
            <option value="country">Pa√≠s</option>
            <option value="actor">Actor</option>
            <option value="director">Director</option>
            <option value="year">A√±o</option>
          </select>
        </label>
        <label class="chart-selector media-actor-filter" id="media-actor-filter" for="media-actor-filter-select" style="display:none">
          <span>Actor/Actriz</span>
          <select class="chart-selector-input" id="media-actor-filter-select">
            <option value="all" selected>Todos</option>
            <option value="male">Actores</option>
            <option value="female">Actrices</option>
          </select>
        </label>
      </div>
      <div class="media-donut-host" id="media-donut"></div>

      <details class="media-legend" id="media-legend" open>
        <summary class="media-legend-summary">
          <span>Desglose</span>
          <span class="media-legend-meta" id="media-legend-meta">0</span>
        </summary>
        <div class="media-legend-body">
          <div class="media-legend-search">
            <input id="media-legend-search" class="media-input" type="search" placeholder="Buscar en desglose..." autocomplete="off" />
          </div>
          <div class="media-legend-list" id="media-donut-legend"></div>
          <button class="btn ghost media-legend-more" id="media-legend-more" type="button" style="display:none">Mostrar m√°s</button>
        </div>
      </details>

      <div class="empty-state small" id="media-chart-empty" style="display:none">A√∫n no hay datos.</div>
    </section>

    <!-- Map -->
    <section class="media-geo" id="media-map-card" style="display:none">
      <div class="geo-header">
        <div>
          <div class="geo-title">Mapa (origen)</div>
          <div class="geo-subtitle">Intensidad seg√∫n n√∫mero de t√≠tulos</div>
        </div>
      </div>

      <div class="geo-map" id="media-world-map"></div>

      <details class="geo-list" id="media-country-panel">
        <summary class="geo-list-summary">Pa√≠ses y n√∫mero de t√≠tulos</summary>
        <div class="geo-list-body" id="media-country-list"></div>
      </details>

      <div class="media-geo-hint" id="media-map-hint" style="display:none"></div>
    </section>

    <!-- List -->
    <section class="media-list-card" id="media-list-card">
      <div class="media-list-head">
        <div class="media-list-title">Listado</div>
        <div class="media-list-meta" id="media-count">0</div>
      </div>
      <div class="media-list-actions" id="media-list-actions" style="display:none">
        <button class="btn ghost btn-compact" id="media-bulk-autofill" type="button">Autocompletar todos (en lote)</button>
      </div>

      <div class="media-list" id="media-list">
        <div class="media-list-spacer" id="media-list-spacer"></div>
        <div class="media-list-items" id="media-list-items"></div>
      </div>
    </section>
  </div>
</section>

<section class="view" id="view-world">
<div class="world-header">
<div class="world-kpis">
<div class="world-kpi">
<div class="label">Mundo visitado</div>
<div class="value" id="world-pct">0.00%</div>
</div>
<div class="world-kpi">
<div class="label">Pa√≠ses</div>
<div class="value"><span id="world-countries">0</span><span class="sub">/ <span id="world-countries-total">0</span></span></div>
</div>
<div class="world-kpi">
<div class="label">Lugares</div>
<div class="value" id="world-places">0</div>
</div>
</div>
<div class="world-controls">
<select id="world-filter">
<option value="day">D√≠a</option>
<option value="week">Semana</option>
<option value="month">Mes</option>
<option value="year">A√±o</option>
<option selected="" value="total">Total</option>
</select>
<label class="btn primary" for="world-add-toggle">+ A√±adir</label>
</div>
</div>
<div class="world-map-wrap">
<div id="world-map"></div>
</div>
<div class="world-bottom"><details class="world-card"><summary class="world-summary"><h3>√öltimas visitas</h3><span class="world-count" id="world-visits-count">0</span></summary><div class="world-list" id="world-visits-list"></div></details><details class="world-card"><summary class="world-summary"><h3>Watchlist</h3><span class="world-count" id="world-watch-count">0</span></summary><div class="world-list"><div class="world-watch-row"><input autocomplete="off" id="world-watch-q" placeholder="A√±adir pa√≠s a watchlist‚Ä¶" type="search"/><button class="btn primary" id="world-watch-add" type="button">A√±adir</button></div><div class="world-list" id="world-watch-list"></div></div></details></div>
<!-- Modal toggle + modal -->
<input class="world-modal-toggle" hidden="" id="world-add-toggle" type="checkbox"/>
<div class="world-modal">
<label class="world-modal-backdrop" for="world-add-toggle"></label>
<div class="world-modal-sheet">
<div class="world-modal-header">
<div class="title">A√±adir visita</div>
<label class="btn" for="world-add-toggle">Cerrar</label>
</div>
<div class="world-modal-grid">
<select id="world-kind">
<option value="country">Pa√≠s</option>
<option selected="" value="city">Ciudad</option>
<option value="town">Pueblo</option>
</select>
<input autocomplete="off" id="world-place-q" placeholder="Buscar (usa el mapa del mundo real)..."/>
<div class="world-list" id="world-place-results"></div>
<div class="world-modal-actions">
<button class="btn primary" id="world-place-save" type="button">Guardar</button>
</div>
</div>
</div>
</div>
</section>

<section class="view view-gym" id="view-gym">
<div class="gym-wrap scroll">
<div class="gym-screen gym-screen-active" id="gym-home">
<div class="gym-hero">
<div>
<div class="gym-title">Gym</div>
<div class="gym-subtitle"></div>
</div>
<div>
<button class="gym-btn gym-btn-ghost" id="gym-open-stats" type="button">üìä</button>
</div>
</div>

<div class="gym-section">
<div class="gym-section-header">
<div class="gym-section-title">Workouts</div>
<select class="gym-select" id="gym-history-range">
<option value="all">Todo el tiempo</option>
</select>
</div>
<button class="gym-btn gym-btn-primary" id="gym-start-workout" type="button">Empezar un entrenamiento vac√≠o</button>
</div>

<div class="gym-section">
<div class="gym-card gym-bodyweight-card">
<label class="gym-field">
<span>Fecha</span>
<input id="gym-body-date" type="date"/>
</label>
<div class="gym-body-grid">
<label class="gym-field">
<span>Peso (kg)</span>
<input id="gym-body-weight" inputmode="decimal" placeholder="Ej: 72.5 Kg" type="text"/>
</label>
<label class="gym-field">
<span>Altura (cm)</span>
<input id="gym-body-height" inputmode="numeric" placeholder="Ej: 178 cm" type="text"/>
</label>
</div>
<div class="gym-body-meta" id="gym-body-meta">Registra tu peso y altura para usarlo en los sets.</div>
</div>
</div>

<div class="gym-section">
<div class="gym-section-header">
<div class="gym-section-title">Cardio</div>
<button class="gym-btn gym-btn-ghost" id="gym-cardio-new" type="button">+ Nueva sesi√≥n</button>
</div>
<div class="gym-card">
<div class="gym-cardio-list" id="gym-cardio-list"></div>
<div class="gym-empty hidden" id="gym-cardio-empty">No tienes sesiones de cardio registradas.</div>
</div>
</div>

<div class="gym-section">
<div class="gym-section-header">
<div class="gym-section-title">Historial</div>
</div>
<div class="gym-calendar">
<div class="gym-calendar-header">
<button class="icon-btn icon-btn-small" id="gym-cal-prev" type="button">‚Äπ</button>
<div class="gym-calendar-title" id="gym-cal-label"></div>
<button class="icon-btn icon-btn-small" id="gym-cal-next" type="button">‚Ä∫</button>
</div>
<div class="gym-calendar-grid" id="gym-calendar-grid"></div>
</div>
<div class="gym-history-list" id="gym-history-list"></div>
<div class="gym-empty hidden" id="gym-history-empty">A√∫n no tienes entrenamientos registrados.</div>
</div>
</div>

<div class="gym-screen" id="gym-workout">
<div class="gym-workout-header gym-header">
<button class="icon-btn icon-btn-small" id="gym-back" type="button">‚Äπ</button>
<div class="gym-workout-title">
<div class="gym-workout-name-row">
<input class="gym-title" id="gym-workout-name" placeholder="Nombre del entrenamiento" type="text"/>
<button class="gym-emoji-btn" id="gym-workout-emoji" type="button" aria-label="Editar emoji de sesi√≥n">üôÇ</button>
</div>
<input class="gym-date" id="gym-workout-date" type="date"/>
</div>
<button class="gym-btn gym-btn-primary" id="gym-finish-workout" type="button">Finalizar</button>
</div>
<div class="gym-metrics">
<div class="gym-metric">
<div class="gym-metric-label">Duraci√≥n</div>
<div class="gym-metric-value" id="gym-metric-duration">
<span class="gym-metric-main" id="gym-metric-duration-main">0m</span>
<span class="gym-metric-pr" id="gym-metric-duration-pr" hidden>üèÜ</span>
</div>
<div class="gym-metric-sub" id="gym-metric-duration-sub">‚Äî</div>
<div class="gym-metric-progress" id="gym-metric-duration-progress" aria-hidden="true">
<span class="gym-metric-bar" id="gym-metric-duration-bar"></span>
</div>
</div>
<div class="gym-metric">
<div class="gym-metric-label">Volumen</div>
<div class="gym-metric-value" id="gym-metric-volume">
<span class="gym-metric-main" id="gym-metric-volume-main">0 kg</span>
<span class="gym-metric-pr" id="gym-metric-volume-pr" hidden>üèÜ</span>
</div>
<div class="gym-metric-sub" id="gym-metric-volume-sub">‚Äî</div>
<div class="gym-metric-progress" id="gym-metric-volume-progress" aria-hidden="true">
<span class="gym-metric-bar" id="gym-metric-volume-bar"></span>
</div>
</div>
<div class="gym-metric">
<div class="gym-metric-label">Ejercicios</div>
<div class="gym-metric-value" id="gym-metric-exercises">
<span class="gym-metric-main" id="gym-metric-exercises-main">0/0</span>
<span class="gym-metric-pr" id="gym-metric-exercises-pr" hidden>üèÜ</span>
</div>
<div class="gym-metric-sub" id="gym-metric-exercises-sub">max: ‚Äî</div>
<div class="gym-metric-progress" id="gym-metric-exercises-progress" aria-hidden="true">
<span class="gym-metric-bar" id="gym-metric-exercises-bar"></span>
</div>
</div>
</div>
<div class="gym-exercise-list" id="gym-workout-exercises"></div>
<div class="gym-workout-actions">
<button class="gym-btn gym-btn-ghost" id="gym-discard-workout" type="button">Descartar</button>
<button class="gym-btn gym-btn-primary" id="gym-add-exercise" type="button">+ A√±adir ejercicios</button>
</div>
</div>

<div class="gym-screen" id="gym-stats">
<div class="gym-workout-header gym-header">
<button class="icon-btn icon-btn-small" id="gym-stats-back" type="button">‚Äπ</button>
<div class="gym-workout-title">
<div class="gym-title">Estad√≠sticas</div>
</div>
</div>
<div class="gym-section">
<div class="gym-section-header">
<label class="gym-field">
<span>Secci√≥n</span>
<select class="gym-select" id="gym-stats-kind">
<option value="body">Peso corporal</option>
<option value="cardio">Cardio</option>
<option value="exercise">Ejercicio</option>
</select>
</label>
</div>
<div id="gym-stats-controls"></div>
<div class="gym-card">
<div class="gym-stats-chart" id="gym-stats-chart"></div>
<div class="gym-empty hidden" id="gym-stats-empty">No hay datos suficientes para mostrar estad√≠sticas.</div>
</div>
</div>
</div>
</div>

<div class="modal-backdrop hidden" id="gym-exercise-modal">
<div class="modal gym-modal">
<div class="modal-header">
<div class="modal-title">A√±adir ejercicios</div>
<button class="icon-btn" id="gym-exercise-close" type="button">‚úï</button>
</div>
<div class="modal-scroll gym-modal-body">
<input class="gym-search" id="gym-exercise-search" placeholder="Buscar ejercicio" type="search"/>
<div class="gym-chip-row" id="gym-muscle-chips"></div>
<div class="gym-exercise-list-modal" id="gym-exercise-list"></div>
<div class="gym-empty hidden" id="gym-exercise-empty">
<div>No encontramos ejercicios.</div>
<button class="gym-btn gym-btn-primary" id="gym-create-cta" type="button">
Crear ‚Äú<span id="gym-create-cta-text"></span>‚Äù
</button>
</div>
<div class="addex-actions">
<button class="gym-btn gym-btn-primary" id="gym-create-toggle" type="button">+ Crear nuevo ejercicio</button>
</div>
</div>
</div>
</div>

<div class="modal-backdrop hidden gym-modal-stacked" id="gym-create-modal">
<div class="modal gym-modal">
<div class="modal-header">
<div class="modal-title">Crear ejercicio</div>
<button class="icon-btn" id="gym-create-close" type="button">‚úï</button>
</div>
<div class="modal-scroll gym-modal-body">
    <div class="gym-create-form">
      <label class="gym-field">
      <span></span>
      <input id="gym-create-name" placeholder="Nombre del ejercicio" type="text"/>
      </label>
      <label class="gym-field">
      <span></span>
      <select id="gym-create-type" class="gym-select">
      <option value="strength">Fuerza</option>
      <option value="cardio">Cardio</option>
      </select>
      </label>
      <label class="gym-field" id="gym-create-strength-type-field">
      <span></span>
      <select id="gym-create-strength-type" class="gym-select">
      <option value="reps">Repeticiones</option>
      <option value="time">Tiempo</option>
      </select>
      </label>
    </div>
<div class="gym-chip-row" id="gym-create-muscle-chips"></div>
<div class="gym-field">
<span></span>
<label class="favorite-toggle">
<input id="gym-create-unilateral" type="checkbox"/>
<span aria-hidden="true" class="favorite-icon">‚Üî</span>
<span>Unilateral</span>
</label>
</div>
<button class="gym-btn gym-btn-primary" id="gym-create-exercise" type="button">Crear</button>
</div>
</div>
</div>

<div class="modal-backdrop hidden" id="gym-exercise-detail-modal">
<div class="modal gym-modal gym-exdetail">
<div class="modal-header gym-exdetail-head">
<div class="gym-exdetail-left">
<div class="gym-exdetail-emoji" id="gym-exdetail-emoji">üí™</div>
<div class="gym-exdetail-titles">
<div class="modal-title" id="gym-exdetail-title">‚Äî</div>
<div class="gym-exdetail-sub" id="gym-exdetail-sub">‚Äî</div>
</div>
</div>
<div class="gym-exdetail-actions">
<button class="gym-btn gym-btn-ghost" id="gym-exdetail-edit" type="button">Editar</button>
<button class="icon-btn" id="gym-exdetail-close" type="button">‚úï</button>
</div>
</div>

<div class="modal-scroll gym-modal-body">
<div class="gym-exdetail-kpis" id="gym-exdetail-kpis"></div>

<div class="gym-exdetail-controls" id="gym-exdetail-controls"></div>

<div class="gym-card">
<div id="gym-exdetail-chart" class="gym-stats-chart"></div>
<div id="gym-exdetail-empty" class="gym-empty hidden">Sin datos a√∫n.</div>
</div>

<button class="gym-btn" id="gym-exdetail-delete" type="button">Eliminar ejercicio</button>
</div>
</div>
</div>

<div class="modal-backdrop hidden" id="gym-template-modal">
<div class="modal gym-modal">
<div class="modal-header">
<div class="modal-title">Nuevo entrenamiento</div>
<button class="icon-btn" id="gym-template-close" type="button">‚úï</button>
</div>
<div class="modal-scroll gym-modal-body">
<label class="gym-field">
<span>Nombre</span>
<input id="gym-template-name" placeholder="Ej. Pierna" type="text"/>
</label>
<button class="gym-btn gym-btn-primary" id="gym-create-empty" type="button">Crear nuevo</button>
<div class="gym-template-list" id="gym-template-list"></div>
<div class="gym-empty hidden" id="gym-template-empty">No tienes plantillas guardadas.</div>
</div>
</div>
</div>
</section>

<div class="modal-backdrop hidden" id="gym-cardio-modal">
<div class="modal gym-modal">
<div class="modal-header">
<div class="modal-title">Sesi√≥n de cardio</div>
<button class="icon-btn" id="gym-cardio-close" type="button">‚úï</button>
</div>
<div class="modal-scroll gym-modal-body">
<label class="gym-field">
<span>Nombre</span>
<input id="gym-cardio-name" placeholder="Ej. Correr" type="text"/>
</label>
<label class="gym-field">
<span>Fecha</span>
<input id="gym-cardio-date" type="date"/>
</label>
<label class="gym-field">
<span>Objetivo (km)</span>
<input id="gym-cardio-target" inputmode="decimal" placeholder="Ej. 5" type="text"/>
</label>
<label class="gym-field">
<span>Distancia (km)</span>
<input id="gym-cardio-distance" inputmode="decimal" placeholder="Ej. 4.2" type="text"/>
</label>
<div class="gym-cardio-time" id="gym-cardio-time">00:00</div>
<div class="gym-cardio-controls">
<button class="gym-btn gym-btn-primary" id="gym-cardio-start" type="button">Start</button>
<button class="gym-btn gym-btn-ghost hidden" id="gym-cardio-pause" type="button">Pause</button>
<button class="gym-btn gym-btn-primary hidden" id="gym-cardio-resume" type="button">Resume</button>
<button class="gym-btn gym-btn-ghost hidden" id="gym-cardio-finish" type="button">Finish</button>
</div>
<div class="gym-body-meta" id="gym-cardio-summary">Introduce distancia para calcular ritmo o velocidad.</div>
<div class="gym-body-meta hidden" id="gym-cardio-progress"></div>
</div>
</div>
</div>

<nav class="bottom-nav"><button class="nav-btn nav-btn-active" data-view="view-main">üè†</button>
<button class="nav-btn" data-view="view-books">üìñ</button>
<button class="nav-btn" data-view="view-videos">üìπ</button>
<button class="nav-btn" data-view="view-recipes">üç≥</button>
<button class="nav-btn" data-view="view-habits">‚úÖ</button>
<button class="nav-btn" data-view="view-games" title="Juegos" aria-label="Juegos">üéÆ</button>
<button class="nav-btn" data-view="view-media">üéûÔ∏è</button>
<button class="nav-btn" data-view="view-world">üåç</button>
<button class="nav-btn" data-view="view-gym">üèãÔ∏è</button>
</nav>

<!-- MODAL LIBRO -->
<div class="modal-backdrop hidden" id="book-modal-backdrop">
<div class="modal">
<div class="modal-handle"></div>
<div class="modal-header">
<div class="modal-title" id="book-modal-title">Nuevo libro</div>
<button class="icon-btn" id="book-modal-close">‚úï</button>
</div>
<form class="modal-form" id="book-form">
<input id="book-id" type="hidden"/>
<div class="modal-scroll sheet-body">
<div class="sheet-section">
<div class="sheet-section-title">Detalles</div>
<div class="field">
<span class="field-label">ISBN</span>
<div class="isbn-input-row">
<input autocomplete="off" id="book-isbn" inputmode="numeric" placeholder="978..." type="text"/>
<button class="btn ghost btn-compact" id="book-isbn-search" type="button">Buscar</button>
</div>
<div class="isbn-status" id="book-isbn-status">Autocompleta t√≠tulo, autor, a√±o y p√°ginas.</div>
<div class="isbn-results" id="book-isbn-results" style="display:none;"></div>
</div>
<label class="field">
<span class="field-label">T√≠tulo</span>
<input id="book-title" required="" type="text"/>
</label>
<label class="favorite-toggle">
<input id="book-favorite" type="checkbox"/>
<span aria-hidden="true" class="favorite-icon">‚òÖ</span>
<span>Marcar como favorito</span>
</label>
<div class="form-grid row-2">
<label class="field">
<span class="field-label">Autor</span>
<input id="book-author" type="text"/>
</label>
<label class="field">
<span class="field-label">A√±o</span>
<input id="book-year" inputmode="numeric" type="number"/>
</label>
</div>
<div class="form-grid row-2">
<label class="field">
<span class="field-label">Categor√≠a</span>
<div class="field-inline">
<select aria-label="Categor√≠a" id="book-genre">
<option value="">‚Äî</option>
</select>
<button aria-label="Eliminar categor√≠a" class="icon-btn genre-remove-btn" id="genre-remove-btn" type="button">‚àí</button>
<button aria-label="A√±adir categor√≠a" class="icon-btn genre-add-btn" id="genre-add-btn" type="button">+</button>
</div>
</label>
<label class="field">
<span class="field-label">Idioma</span>
<input id="book-language" type="text"/>
</label>
</div>
<label class="field">
<span class="field-label">Pa√≠s / origen</span>
<input id="book-country" list="country-options" placeholder="Espa√±a, M√©xico, Estados Unidos..." type="text"/>
</label>
</div>
<div class="sheet-section">
<div class="sheet-section-title">Progreso</div>
<div class="form-grid row-2">
<label class="field">
<span class="field-label">N.¬∫ p√°ginas</span>
<input id="book-pages" inputmode="numeric" min="1" required="" type="number"/>
</label>
<label class="field">
<span class="field-label">P√°gina actual</span>
<input id="book-current-page" inputmode="numeric" min="0" type="number" value="0"/>
</label>
</div>
<label class="field">
<span class="field-label">Estado</span>
<select id="book-status">
<option value="reading">Leyendo</option>
<option value="planned">Pendiente</option>
<option value="finished">Terminado</option>
</select>
</label>
<label class="field checkbox-field">
<div class="checkbox-field-row">
<div>
<div class="checkbox-field-title">Le√≠do en el pasado</div>
<div class="checkbox-field-hint">No registrar√° fecha de finalizaci√≥n</div>
</div>
<input id="book-finished-past" type="checkbox"/>
</div>
</label>
</div>
</div>
<div class="modal-footer sheet-footer">
<button class="btn ghost" id="book-modal-cancel" type="button">Cancelar</button>
<button class="btn primary" type="submit">Guardar</button>
</div>
</form>
</div>
</div>
<!-- FICHA LIBRO -->
<div class="modal-backdrop hidden" id="book-detail-backdrop">
<div class="modal book-detail-modal">
<div class="modal-handle"></div>
<div class="modal-header">
<div class="modal-title" id="book-detail-title">Ficha del libro</div>
<button class="icon-btn" id="book-detail-close">‚úï</button>
</div>
<div class="modal-body book-detail-body">
<div class="book-detail-top">
<label class="favorite-toggle">
<input id="book-detail-favorite" type="checkbox"/>
<span aria-hidden="true" class="favorite-icon">‚òÖ</span>
<span>Favorito</span>
</label>
<div class="book-detail-status" id="book-detail-status"></div>
</div>
<div class="spec-block compact">
<div class="spec-block-title">Datos r√°pidos</div>
<div class="spec-grid">
<div class="spec-item">
<span class="spec-label">Autor</span>
<div class="spec-value" id="book-detail-author">‚Äî</div>
</div>
<div class="spec-item">
<span class="spec-label">A√±o</span>
<div class="spec-value" id="book-detail-year">‚Äî</div>
</div>
<div class="spec-item">
<span class="spec-label">Siglo</span>
<div class="spec-value" id="book-detail-century">‚Äî</div>
</div>
<div class="spec-item">
<span class="spec-label">G√©nero</span>
<div class="spec-value" id="book-detail-genre">‚Äî</div>
</div>
<div class="spec-item">
<span class="spec-label">Idioma</span>
<div class="spec-value" id="book-detail-language">‚Äî</div>
</div>
<div class="spec-item">
<span class="spec-label">Pa√≠s</span>
<div class="spec-value" id="book-detail-country">‚Äî</div>
</div>
<div class="spec-item">
<span class="spec-label">P√°ginas</span>
<div class="spec-value" id="book-detail-pages">‚Äî</div>
</div>
<div class="spec-item">
<span class="spec-label">Progreso</span>
<div class="spec-value" id="book-detail-progress">‚Äî</div>
</div>
<div class="spec-item">
<span class="spec-label">Finalizado</span>
<div class="spec-value" id="book-detail-finished">‚Äî</div>
</div>
<div class="spec-item spec-notes">
<span class="spec-label">Notas</span>
<div class="spec-value" id="book-detail-notes">Sin notas</div>
</div>
</div>
</div>
<details class="book-detail-quotes" id="book-detail-quotes" open>
<summary>
<span>Citas asociadas</span>
<span class="books-finished-count" id="book-detail-quotes-count">0</span>
</summary>
<div class="book-detail-quotes-panel">
<input class="book-detail-quotes-search" id="book-detail-quotes-search" type="search" placeholder="Buscar por texto o p√°gina"/>
<div class="book-detail-quotes-body" id="book-detail-quotes-body"></div>
</div>
</details>
</div>
<div class="modal-footer book-detail-footer sticky-footer">
<button class="btn primary btn-compact" id="book-detail-edit" type="button">Editar</button>
<button class="btn ghost" id="book-detail-close-btn" type="button">Cerrar</button>
</div>
</div>
</div>
<!-- MODAL V√çDEO -->
<div class="modal-backdrop hidden" id="video-modal-backdrop">
<div class="modal">
<div class="modal-handle"></div>
<div class="modal-header">
<div class="modal-title" id="video-modal-title">Nuevo v√≠deo</div>
<button class="icon-btn" id="video-modal-close">‚úï</button>
</div>
<form class="modal-form" id="video-form">
<input id="video-id" type="hidden"/>
<div class="modal-scroll sheet-body">
<div class="sheet-section">
<div class="sheet-section-title">B√°sico</div>
<label class="field">
<span class="field-label">T√≠tulo</span>
<input id="video-title" required="" type="text"/>
</label>
<label class="field">
<span class="field-label">Palabras de guion <em class="hint">(objetivo 2000)</em></span>
<input id="video-script-words" inputmode="numeric" min="0" type="number" value="0"/>
</label>
</div>
<div class="sheet-section">
<div class="sheet-section-title">Duraci√≥n</div>
<div class="form-grid row-2">
<label class="field">
<span class="field-label">Total</span>
<div class="time-split">
<input class="time-input" id="video-duration-min" inputmode="numeric" min="0" placeholder="min" type="number"/>
<span class="time-sep">:</span>
<input class="time-input" id="video-duration-sec" inputmode="numeric" max="59" min="0" placeholder="seg" type="number"/>
</div>
</label>
<label class="field">
<span class="field-label">Editado</span>
<div class="time-split">
<input class="time-input" id="video-edited-min" inputmode="numeric" min="0" placeholder="min" type="number"/>
<span class="time-sep">:</span>
<input class="time-input" id="video-edited-sec" inputmode="numeric" max="59" min="0" placeholder="seg" type="number"/>
</div>
</label>
</div>
</div>
<div class="sheet-section">
<div class="sheet-section-title">Plan</div>
<div class="form-grid row-2">
<label class="field">
<span class="field-label">Fecha propuesta</span>
<input id="video-publish-date" type="date"/>
</label>
<label class="field">
<span class="field-label">Estado</span>
<select id="video-status">
<option value="script">Guion</option>
<option value="recording">Grabaci√≥n</option>
<option value="editing">Edici√≥n</option>
<option value="scheduled">Programado</option>
<option value="published">Publicado</option>
<option value="in_progress">Curso (legacy)</option>
<option value="planned">Planificado (legacy)</option>
</select>
</label>
</div>
</div>
</div>
<div class="modal-footer sheet-footer">
<button class="btn ghost" id="video-modal-cancel" type="button">Cancelar</button>
<button class="btn primary" id="video-form-save" type="submit">Guardar</button>
</div>
</form>
</div>
</div>
<!-- MODAL REGISTRO -->
<div class="modal-backdrop hidden" id="record-modal-backdrop">
<div class="modal">
<div class="modal-handle"></div>
<div class="modal-header">
<div class="modal-title" id="record-modal-title">Editar registro</div>
<button class="icon-btn" id="record-modal-close" aria-label="Cerrar">‚úï</button>
</div>
<form class="modal-form" id="record-form">
<input id="record-id" type="hidden"/>
<input id="record-day" type="hidden"/>
<input id="record-video-id" type="hidden"/>
<div class="modal-scroll sheet-body">
<div class="sheet-section">
<div class="sheet-section-title">Registro</div>
<label class="field">
<span class="field-label">Palabras</span>
<input id="record-words" inputmode="numeric" min="0" type="number" value="0"/>
</label>
<label class="field">
<span class="field-label">Tiempo trabajado</span>
<div class="time-split">
<input class="time-input" id="record-time-min" inputmode="numeric" min="0" placeholder="min" type="number"/>
<span class="time-sep">:</span>
<input class="time-input" id="record-time-sec" inputmode="numeric" max="59" min="0" placeholder="seg" type="number"/>
</div>
</label>
</div>
</div>
<div class="modal-footer sheet-footer">
<button class="btn ghost" id="record-modal-cancel" type="button">Cancelar</button>
<button class="btn primary" id="record-form-save" type="submit">Guardar cambios</button>
</div>
</form>
</div>
</div>
<!-- MODAL ELIMINAR -->
<div class="modal-backdrop hidden" id="confirm-delete-backdrop">
<div class="modal">
<div class="modal-handle"></div>
<div class="modal-header">
<div class="modal-title" id="confirm-delete-title">Eliminar definitivamente</div>
<button class="icon-btn" id="confirm-delete-close" aria-label="Cerrar">‚úï</button>
</div>
<div class="modal-body">
<p id="confirm-delete-text">¬øEliminar definitivamente?</p>
</div>
<div class="modal-footer">
<button class="btn ghost" id="confirm-delete-cancel" type="button">Cancelar</button>
<button class="btn danger" id="confirm-delete-confirm" type="button">Eliminar</button>
</div>
</div>
</div>
<!-- MODAL IDEA -->
<div class="modal-backdrop hidden" id="idea-modal-backdrop">
<div class="modal">
<div class="modal-handle"></div>
<div class="modal-header">
<div class="modal-title" id="idea-modal-title">Nueva idea</div>
<button class="icon-btn" id="idea-modal-close">‚úï</button>
</div>
<form class="modal-form" id="idea-form">
<input id="idea-id" type="hidden"/>
<div class="modal-scroll sheet-body">
<div class="sheet-section">
<div class="sheet-section-title">Idea</div>
<label class="field">
<span class="field-label">T√≠tulo <em class="hint">(obligatorio)</em></span>
<input id="idea-title" required="" type="text"/>
</label>
<label class="field">
<span class="field-label">Notas / preguion</span>
<textarea id="idea-notes" placeholder="Escribe el preguion o ideas clave‚Ä¶" rows="5"></textarea>
</label>
<label class="field">
<span class="field-label">Tags / hashtags</span>
<input id="idea-tags" placeholder="amor, culpa, nietzsche" type="text"/>
<span class="hint">Separados por comas. Se guardan como #tags.</span>
</label>
<label class="field">
<span class="field-label">Link inspiraci√≥n (opcional)</span>
<div class="idea-link-row">
<input id="idea-link" placeholder="https://..." type="url"/>
<button class="btn ghost btn-compact" id="idea-add-resource" type="button">A√±adir recurso</button>
</div>
</label>
<div class="form-error" id="idea-form-error" role="alert"></div>
</div>
</div>
<div class="modal-footer sheet-footer">
<button class="btn ghost" id="idea-modal-cancel" type="button">Cancelar</button>
<button class="btn primary" id="idea-form-save" type="submit">Guardar</button>
</div>
</form>
</div>
</div>
<!-- MODAL ASIGNAR TIEMPO A V√çDEO -->
<div class="modal-backdrop hidden" id="assign-work-backdrop">
<div class="modal">
<div class="modal-header">
<div class="modal-title">¬øEn qu√© v√≠deo has trabajado?</div>
<button class="icon-btn" id="assign-work-close">‚úï</button>
</div>
<div class="modal-body">
<div id="assign-work-summary" style="opacity:.75; margin-bottom:10px;"></div>
<label class="field">
<span>V√≠deo</span>
<select id="assign-work-select"></select>
</label>
</div>
<div class="modal-footer">
<button class="btn ghost" id="assign-work-skip" type="button">No asignar</button>
<button class="btn primary" id="assign-work-save" type="button">Asignar</button>
</div>
</div>
</div>
<!-- MODAL RECETA -->
<div class="modal-backdrop hidden" id="recipe-modal-backdrop">
<div class="modal">
<div class="modal-handle"></div>
<div class="modal-header">
<div class="modal-title" id="recipe-modal-title">Nueva receta</div>
<button class="icon-btn" id="recipe-modal-close">‚úï</button>
</div>
<form class="modal-form" id="recipe-form">
<input id="recipe-id" type="hidden"/>
<div class="modal-scroll sheet-body">
<div class="sheet-section">
<div class="sheet-section-title">Datos clave</div>
<div class="recipe-import">
<button class="btn ghost btn-compact" id="recipe-import-toggle" type="button">
    Importar
  </button>
<div class="recipe-import-box hidden" id="recipe-import-box">
<textarea class="builder-textarea recipe-import-text" id="recipe-import-text" placeholder="Pega aqu√≠ el bloque RECETA_V1‚Ä¶ (desde ChatGPT)" rows="7"></textarea>
<div class="recipe-import-actions">
<button class="btn primary btn-compact" id="recipe-import-btn" type="button">Aplicar</button>
<button class="btn ghost btn-compact" id="recipe-import-clear" type="button">Limpiar</button>
<div class="recipe-import-status" id="recipe-import-status"></div>
</div>
</div>
</div>
<label class="field">
<span class="field-label">Nombre del plato</span>
<input id="recipe-name" required="" type="text"/>
</label>
<div class="form-grid row-2">
<label class="field">
<span class="field-label">Tipo de comida</span>
<select id="recipe-meal" required="">
<option value="desayuno">Desayuno</option>
<option value="comida">Comida</option>
<option value="cena">Cena</option>
<option value="snack">Snack</option>
</select>
</label>
<label class="field">
<span class="field-label">Saludable</span>
<select id="recipe-health" required="">
<option value="sana">Sana</option>
<option value="equilibrada">Equilibrada</option>
<option value="insana">Insana</option>
</select>
</label>
</div>
<label class="field">
<span class="field-label">Etiquetas (separadas por coma)</span>
<input id="recipe-tags" placeholder="r√°pida, horno, pasta..." type="text"/>
</label>
<label class="field">
<span class="field-label">Pa√≠s / origen</span>
<input id="recipe-country" list="country-options" placeholder="Italia, Per√∫, Estados Unidos..." type="text"/>
</label>
<div class="field recipe-photo-field">
  <span class="field-label">Foto</span>
  <div class="recipe-photo-wrap">
    <img id="recipe-image-preview" class="recipe-photo-preview" alt="Foto de la receta" />
    <div class="recipe-photo-actions">
      <button class="btn ghost btn-compact" id="recipe-image-camera" type="button">üì∑ C√°mara</button>
      <button class="btn ghost btn-compact" id="recipe-image-gallery" type="button">üñºÔ∏è Galer√≠a</button>
      <button class="btn ghost danger btn-compact" id="recipe-image-remove" type="button">Quitar</button>
    </div>
    <div class="hint recipe-photo-status" id="recipe-image-status"></div>
    <input id="recipe-image-file" type="file" accept="image/*" hidden />
  </div>
</div>

<div class="form-grid row-2">
<label class="field">
<span class="field-label">Valoraci√≥n</span>
<input id="recipe-rating" max="5" min="0" step="0.5" type="number" value="4"/>
</label>
<label class="field">
<span class="field-label">√öltima vez cocinada</span>
<input id="recipe-last-cooked" type="date"/>
</label>
</div>
<label class="field">
<span class="field-label">Notas</span>
<textarea id="recipe-notes" placeholder="Notas r√°pidas, truco o acompa√±amiento..." rows="3"></textarea>
</label>
<div class="form-grid row-2">
<label class="favorite-toggle">
<input id="recipe-favorite" type="checkbox"/>
<span aria-hidden="true" class="favorite-icon">‚òÖ</span>
<span>Marcar como favorita</span>
</label>
<label class="laura-check">
<input id="recipe-laura" type="checkbox"/>
<span aria-hidden="true" class="laura-check-mark"></span>
<span>Aprobaci√≥n de Laura</span>
</label>
</div>
</div>
<div class="sheet-section">
<div class="sheet-section-title">Receta editable</div>
<p class="section-hint">Organiza ingredientes y pasos para que aparezcan en el recetario a pantalla completa.</p>
<div class="recipe-builder-grid">
<div class="recipe-builder-column">
<div class="builder-header">
<div>
<div class="builder-title">Ingredientes</div>
<div class="builder-subtitle">A√±ade tantos como necesites</div>
</div>
<button class="btn ghost btn-compact" id="recipe-add-ingredient" type="button">+ Ingrediente</button>
</div>
<div class="recipe-ingredients-list" id="recipe-ingredients-list"></div>
</div>
<div class="recipe-builder-column">
<div class="builder-header">
<div>
<div class="builder-title">Pasos</div>
<div class="builder-subtitle">T√≠tulo y descripci√≥n para cada paso</div>
</div>
<button class="btn ghost btn-compact" id="recipe-add-step" type="button">+ Paso</button>
</div>
<div class="recipe-steps-list" id="recipe-steps-list"></div>
</div>
</div>
</div>
</div>
<div class="modal-footer sheet-footer">
<button class="btn ghost danger footer-start" id="recipe-delete" type="button">Eliminar</button>
<button class="btn ghost" id="recipe-modal-cancel" type="button">Cancelar</button>
<button class="btn primary" type="submit">Guardar</button>
</div>
</form>
</div>
</div>
<!-- RECETARIO A PANTALLA COMPLETA -->
<div class="recipe-detail-backdrop hidden" id="recipe-detail-backdrop">
<article aria-modal="true" class="recipe-detail-card" role="dialog">
<header class="recipe-detail-header">
<div class="recipe-detail-top">
<div class="recipe-detail-headings">
<h2 class="recipe-detail-title" id="recipe-detail-title">Receta</h2>
<div class="recipe-detail-chips">
<div class="recipe-detail-chip" id="recipe-detail-meal"></div>
<div class="recipe-detail-tags" id="recipe-detail-tags"></div>
</div>
</div>
<div class="recipe-detail-actions">
<button aria-label="Seguimiento" class="icon-btn icon-btn-large recipe-bookmark-btn" id="recipe-detail-bookmark">üîñ</button>
<button aria-label="Cerrar" class="icon-btn icon-btn-large" id="recipe-detail-close">‚úï</button>
</div>
</div>
<div class="recipe-detail-hero" id="recipe-detail-hero" style="display:none;">
  <img id="recipe-detail-image" alt="Foto de la receta" loading="lazy" />
</div>
<div class="recipe-detail-specs">
<div class="spec-block">
<div class="spec-block-title">Datos r√°pidos</div>
<div class="spec-grid" id="recipe-detail-meta"></div>
</div>
<div class="spec-block">
<div class="spec-block-title">Datos clave</div>
<div class="spec-grid spec-grid-secondary" id="recipe-detail-grid"></div>
</div>
</div>
</header>
<div class="recipe-detail-body">
<div aria-label="Contenido de la receta" class="recipe-detail-tabbar" id="recipe-detail-tabbar" role="tablist">
<button aria-selected="true" class="recipe-tab is-active" data-target="ingredients" role="tab" type="button">Ingredientes</button>
<button aria-selected="false" class="recipe-tab" data-target="steps" role="tab" type="button">Pasos</button>
</div>
<section class="recipe-detail-section recipe-detail-panel is-active" data-panel="ingredients" role="tabpanel">
<div class="section-subtitle">Marca al preparar</div>
<div class="recipe-detail-ingredients" id="recipe-detail-ingredients"></div>
</section>
<section aria-hidden="true" class="recipe-detail-section recipe-detail-panel" data-panel="steps" role="tabpanel">
<div class="section-subtitle">Solo una lista visible</div>
<div class="recipe-detail-steps" id="recipe-detail-steps"></div>
</section>
<section class="recipe-detail-section recipe-notes-section" id="recipe-detail-notes-wrapper" style="display:none;">
<div class="spec-block-title">Notas</div>
<p class="recipe-detail-notes" id="recipe-detail-notes"></p>
</section>
</div>
<div class="recipe-detail-actions-bar">
<button class="btn primary btn-compact" id="recipe-detail-edit">Editar</button>
<button class="btn ghost danger btn-compact" id="recipe-detail-delete">Eliminar</button>
<button class="btn ghost" id="recipe-detail-close-bottom">Cerrar</button>
</div>
</article>
</div>
<!-- MODAL H√ÅBITO -->
<div class="modal-backdrop hidden" id="habit-modal-backdrop">
<div class="modal habit-modal">
<div class="modal-handle"></div>
<div class="modal-header">
<div class="modal-title" id="habit-modal-title">Nuevo h√°bito</div>
<button class="icon-btn" id="habit-modal-close">‚úï</button>
</div>
<form class="modal-form" id="habit-form">
<input id="habit-id" type="hidden"/>
<div class="modal-scroll sheet-body">
    <div class="sheet-section">
    <div class="sheet-section-title">Detalles</div>
        <div class="habits-details">
          <label class="field">
          <span class="field-label">Nombre</span>
          <input id="habit-name" required="" type="text"/>
          </label>
          <label class="field">
          <span class="field-label">Emoji/Icono</span>
          <input id="habit-emoji" inputmode="text" maxlength="4" placeholder="üí™" type="text"/>
          </label>
          <label class="field">
          <span class="field-label">Color</span>
          <input id="habit-color" type="color" value="#7f5dff"/>
          </label>
          <label class="field field-inline-toggle">
            <span class="field-label">Excluir de ‚Äúdominante del d√≠a‚Äù</span>
            <input id="habit-exclude-dominant" type="checkbox"/>
          </label>

          <label class="field">
            <span class="field-label">Grupo</span>
            <select id="habit-group-select"></select>
          </label>
        </div>

    <div class="habit-group-manage">
      <input id="habit-group-new" placeholder="Nuevo grupo" type="text"/>
      <button class="btn ghost btn-compact" id="habit-group-create" type="button">Crear</button>
    </div>
    <div class="habit-group-manage">
      <input id="habit-group-rename" placeholder="Renombrar grupo" type="text"/>
      <button class="btn ghost btn-compact" id="habit-group-rename-btn" type="button">Renombrar</button>
      <button class="btn ghost danger btn-compact" id="habit-group-delete-btn" type="button">Eliminar</button>
    </div>

    <label class="field checkbox-field">
      <div class="checkbox-field-row">
        <div>
          <div class="checkbox-field-title">Agrupar en ‚ÄúPrivados‚Äù</div>
          <div class="checkbox-field-hint">Se mostrar√° en un desplegable cerrado por defecto (en Pendientes/Hechos).</div>
        </div>
        <input id="habit-group-private" type="checkbox"/>
      </div>
    </label>

    <label class="field checkbox-field">
      <div class="checkbox-field-row">
        <div>
          <div class="checkbox-field-title">Agrupar en ‚ÄúPoco uso‚Äù</div>
          <div class="checkbox-field-hint">Se mostrar√° en un desplegable cerrado por defecto (en Pendientes/Hechos).</div>
        </div>
        <input id="habit-group-lowuse" type="checkbox"/>
      </div>
    </label>

    </div>
<div class="sheet-section habit-params-section">
<div class="sheet-section-title">Par√°metros</div>
<label class="field">
<span class="field-label">A√±adir par√°metro</span>
<div class="habit-params-controls">
<select id="habit-param-select">
  <option value="">Selecciona un par√°metro</option>
  <option value="Laura: S√≠">Laura: S√≠</option>
  <option value="Laura: No">Laura: No</option>
  <option value="Lugar: Dentro">Lugar: Dentro</option>
  <option value="Lugar: Fuera">Lugar: Fuera</option>
  <option value="Tipo: Productivo">Tipo: Productivo</option>
  <option value="Tipo: No productivo">Tipo: No productivo</option>
  <option value="__new__">Crear nuevo‚Ä¶</option>
</select>
<button class="btn ghost btn-compact" id="habit-param-add" type="button">A√±adir</button>
</div>
</label>
<label class="field habit-param-new hidden" id="habit-param-new-wrap">
<span class="field-label">Nuevo par√°metro</span>
<div class="habit-params-controls">
<input id="habit-param-new" placeholder="Ej: Lugar: Fuera" type="text"/>
<button class="btn ghost btn-compact" id="habit-param-create" type="button">Crear</button>
</div>
</label>
<div class="habit-param-chips" id="habit-param-list"></div>
</div>
<div class="sheet-section">
<div class="sheet-section-title">Objetivo</div>
<div class="field">
<span class="field-label">Tipo</span>
<div class="pill-row">
<label class="toggle-pill">
<input checked="" name="habit-goal" type="radio" value="check"/>
<span>Check</span>
</label>
<label class="toggle-pill">
<input name="habit-goal" type="radio" value="time"/>
<span>Tiempo</span>
</label>
<label class="toggle-pill">
<input name="habit-goal" type="radio" value="count"/>
<span>Conteo</span>
</label>
</div>
</div>
<label class="field" id="habit-target-minutes-wrap">
<span class="field-label">Minutos objetivo (opcional)</span>
<input id="habit-target-minutes" inputmode="numeric" min="0" placeholder="25" type="number"/>
</label>
<label class="field" id="habit-count-unit-minutes-wrap" style="display:none">
  <span class="field-label">Minutos por vez (opcional)</span>
  <input id="habit-count-unit-minutes" inputmode="numeric" min="0" placeholder="8" type="number"/>
  <div class="checkbox-field-hint">Si pones 8 y cuentas 2, se registran 16m ese d√≠a.</div>
</label>

<div class="sheet-subsection" id="habit-quick-adds-wrap" style="display:none">
  <div class="sheet-section-title">Atajos</div>
  <div class="quick-add-grid">
    <label class="field">
      <span class="field-label">Bot√≥n 1 (texto)</span>
      <input id="habit-quick1-label" placeholder="+3 min" autocomplete="off"/>
    </label>
    <label class="field">
      <span class="field-label">Bot√≥n 1 (min)</span>
      <input id="habit-quick1-minutes" inputmode="numeric" min="0" placeholder="3" type="number"/>
    </label>
    <label class="field">
      <span class="field-label">Bot√≥n 2 (texto)</span>
      <input id="habit-quick2-label" placeholder="+1 h" autocomplete="off"/>
    </label>
    <label class="field">
      <span class="field-label">Bot√≥n 2 (min)</span>
      <input id="habit-quick2-minutes" inputmode="numeric" min="0" placeholder="60" type="number"/>
    </label>
  </div>
</div>

</div>
<div class="sheet-section">
<div class="sheet-section-title">Frecuencia</div>
<div class="pill-row">
<label class="toggle-pill">
<input checked="" name="habit-schedule" type="radio" value="daily"/>
<span>Cada d√≠a</span>
</label>
<label class="toggle-pill">
<input name="habit-schedule" type="radio" value="days"/>
<span>D√≠as concretos</span>
</label>
</div>
<div class="habit-days-selector" id="habit-days-selector">
<button data-day="1" type="button">L</button>
<button data-day="2" type="button">M</button>
<button data-day="3" type="button">X</button>
<button data-day="4" type="button">J</button>
<button data-day="5" type="button">V</button>
<button data-day="6" type="button">S</button>
<button data-day="0" type="button">D</button>
</div>
</div>
</div>
<div class="modal-footer sheet-footer">
<button class="btn ghost danger footer-start" id="habit-delete" type="button">Eliminar h√°bito</button>
<button class="btn ghost" id="habit-modal-cancel" type="button">Cancelar</button>
<button class="btn primary" type="submit">Guardar</button>
</div>
</form>
</div>
</div>
<!-- MODAL ASIGNAR SESI√ìN -->
<div class="modal-backdrop hidden" id="habit-session-modal">
<div class="modal habit-session-modal">
<div class="modal-handle"></div>
<div class="modal-header">
<div class="modal-title">¬øA qu√© h√°bito asignas esta sesi√≥n?</div>
<button class="icon-btn" id="habit-session-close">‚úï</button>
</div>
<div class="modal-scroll sheet-body">
<div class="field">
<span class="field-label">Buscar</span>
<input id="habit-session-search" placeholder="Nombre del h√°bito" type="search"/>
</div>
<div class="habit-session-last" id="habit-session-last" style="display:none;"></div>
<div class="habit-session-list" id="habit-session-list"></div>
</div>
<div class="modal-footer sheet-footer">
<button class="btn ghost" id="habit-session-cancel">Cancelar</button>
</div>
</div>
</div>
<!-- MODAL TIEMPO MANUAL -->
<div class="modal-backdrop hidden" id="habit-manual-modal">
<div class="modal habit-modal">
<div class="modal-handle"></div>
<div class="modal-header">
<div class="modal-title">A√±adir tiempo</div>
<button class="icon-btn" id="habit-manual-close">‚úï</button>
</div>
<form class="modal-form" id="habit-manual-form">
<div class="modal-scroll sheet-body">
<div class="sheet-section">
<div class="sheet-section-title">Sesi√≥n manual</div>
<label class="field">
<span class="field-label">H√°bito</span>
<select id="habit-manual-habit" required=""></select>
</label>
<div class="inputs">
  <label class="field">
    <span class="field-label">Minutos</span>
    <input id="habit-manual-minutes" min="00:00" placeholder="00:25" required="" step="60" type="time"/>
    </label>
    <label class="field">
    <span class="field-label">Fecha</span>
    <input id="habit-manual-date" type="date"/>
  </label>
  </div>
</div>
</div>
<div class="modal-footer sheet-footer">
<button class="btn ghost" id="habit-manual-cancel" type="button">Cancelar</button>
<button class="btn primary" type="submit">Guardar</button>
</div>
</form>
</div>
</div>
<!-- MODAL EDITAR REGISTROS -->
<div class="modal-backdrop hidden" id="habit-entry-modal-backdrop">
<div class="modal habit-modal">
<div class="modal-handle"></div>
<div class="modal-header">
<div class="modal-title">Editar registros</div>
<button class="icon-btn" id="habit-entry-close">‚úï</button>
</div>
<form class="modal-form" id="habit-entry-form">
<div class="modal-scroll sheet-body">
<div class="sheet-section">
<div class="sheet-section-title">D√≠a</div>
<label class="field">
<span class="field-label">H√°bito</span>
<select id="habit-entry-habit" required=""></select>
</label>
<label class="field">
<span class="field-label">Fecha</span>
<input id="habit-entry-date" required="" type="date"/>
</label>
<div id="habit-entry-check-wrap">
<label class="field">
<span class="field-label">Check</span>
<input id="habit-entry-check" type="checkbox"/>
</label>
</div>
<div id="habit-entry-count-wrap" style="display:none;">
<div class="field">
<span class="field-label">Conteo</span>
<div class="pill-row">
<button class="icon-btn" id="habit-entry-count-minus" type="button">‚àí</button>
<input id="habit-entry-count" inputmode="numeric" min="0" type="number" value="0"/>
<button class="icon-btn" id="habit-entry-count-plus" type="button">+</button>
</div>
</div>
</div>
</div>
<div class="sheet-section">
<div class="sheet-section-title">Sesiones (tiempo)</div>
<div id="habit-entry-sessions"></div>
<div class="hint">Puedes ajustar minutos o borrar sesiones. Para a√±adir una nueva, usa ‚ÄúA√±adir tiempo‚Äù.</div>
</div>
</div>
<div class="modal-footer sheet-footer">
<button class="btn ghost" id="habit-entry-cancel" type="button">Cancelar</button>
<button class="btn primary" type="submit">Guardar</button>
</div>
</form>
</div>
</div>

<!-- MODAL DETALLE DEL D√çA -->
<div class="modal-backdrop hidden" id="habit-day-detail-modal">
<div class="modal habit-modal">
<div class="modal-handle"></div>
<div class="modal-header">
<div class="modal-title" id="habit-day-detail-title">Detalle del d√≠a</div>
<button class="icon-btn" id="habit-day-detail-close">‚úï</button>
</div>
<div class="modal-scroll sheet-body">
<div class="sheet-section">
<div class="sheet-section-title" id="habit-day-detail-date">‚Äî</div>
<div id="habit-day-detail-list"></div>
</div>
</div>
<div class="modal-footer sheet-footer">
<button class="btn ghost" id="habit-day-detail-cancel" type="button">Cerrar</button>
<button class="btn primary" id="habit-day-detail-save" type="button">Guardar</button>
</div>
</div>
</div>
<!-- CONFIRMAR ELIMINACI√ìN H√ÅBITO -->
<div class="modal-backdrop hidden" id="habit-delete-confirm">
<div class="modal habit-modal">
<div class="modal-handle"></div>
<div class="modal-header">
<div class="modal-title">Eliminar h√°bito</div>
<button class="icon-btn" id="habit-delete-close">‚úï</button>
</div>
<div class="modal-body sheet-body">
<p>Vas a archivar el h√°bito <strong id="habit-delete-name"></strong>. Dejar√° de mostrarse y su actividad no contar√° en los reportes.</p>
<div class="warning-text">Esta acci√≥n se puede revertir editando el h√°bito m√°s adelante.</div>
</div>
<div class="modal-footer sheet-footer">
<button class="btn ghost" id="habit-delete-cancel" type="button">Cancelar</button>
<button class="btn danger" id="habit-delete-confirm-btn" type="button">Eliminar</button>
</div>
</div>
</div>

<div class="modal-backdrop hidden" id="game-mode-modal">
<div class="modal habit-modal">
<div class="modal-handle"></div>
<div class="modal-header">
<div class="modal-title" id="game-mode-modal-title">Nuevo modo</div>
<button class="icon-btn" id="game-mode-close" type="button">‚úï</button>
</div>
<form class="modal-form" id="game-mode-form">
<div class="modal-scroll sheet-body game-modal-scroll">
<label class="field">
<span class="field-label">Grupo</span>
<select id="game-group-choice">
<option value="existing">Elegir grupo existente</option>
<option value="new">Crear grupo nuevo</option>
</select>
</label>
<label class="field" id="game-group-existing-wrap">
<span class="field-label">Grupo existente</span>
<select id="game-existing-group"></select>
</label>
<div class="form-grid row-2" id="game-group-new-wrap" style="display:none;">
<label class="field">
<span class="field-label">Nombre del grupo</span>
<input id="game-group-name" type="text" placeholder="Ej. CS2"/>
</label>
<label class="field">
<span class="field-label">Emoji del grupo</span>
<input id="game-group-emoji" type="text" maxlength="3" placeholder="üéÆ"/>
</label>
</div>
<label class="field" id="game-group-habit-wrap" style="display:none;">
<span class="field-label">Vincular h√°bito (grupo)</span>
<select id="game-group-linked-habit"></select>
</label>
<div class="form-grid row-2">
<label class="field">
<span class="field-label">Nombre del modo</span>
<input id="game-mode-name" required type="text" placeholder="Ej. Premier"/>
</label>
<label class="field">
<span class="field-label">Emoji del modo (opcional)</span>
<input id="game-mode-emoji" type="text" maxlength="3" placeholder="‚öîÔ∏è"/>
</label>
</div>
</div>
<div class="modal-footer sheet-footer">
<button class="btn ghost" id="game-mode-cancel" type="button">Cancelar</button>
<button class="btn primary" type="submit">Guardar</button>
</div>
</form>
</div>
</div>

<div class="modal-backdrop hidden" id="game-group-modal">
<div class="modal habit-modal">
<div class="modal-handle"></div>
<div class="modal-header">
<div class="modal-title">Editar grupo</div>
<button class="icon-btn" id="game-group-close" type="button">‚úï</button>
</div>
<form class="modal-form" id="game-group-form">
<input id="game-group-id" type="hidden"/>
<div class="modal-scroll sheet-body">
<div class="form-grid row-2">
<label class="field">
<span class="field-label">Nombre</span>
<input id="game-group-edit-name" required type="text"/>
</label>
<label class="field">
<span class="field-label">Emoji</span>
<input id="game-group-edit-emoji" maxlength="3" type="text"/>
</label>
</div>
<label class="field">
<span class="field-label">Vincular h√°bito</span>
<select id="game-group-edit-habit"></select>
</label>
</div>
<div class="modal-footer sheet-footer">
<button class="btn ghost" id="game-group-cancel" type="button">Cancelar</button>
<button class="btn primary" type="submit">Guardar</button>
</div>
</form>
</div>
</div>

<div class="modal-backdrop hidden" id="game-detail-modal">
<div class="modal habit-modal game-detail-modal">
<div class="modal-handle"></div>
<div class="modal-header">
<div class="modal-title" id="game-detail-title">Detalle modo</div>
<button class="icon-btn" id="game-detail-close" type="button">‚úï</button>
</div>
<div class="modal-scroll sheet-body game-detail-body" id="game-detail-body"></div>
<div class="modal-footer sheet-footer">
<button class="btn ghost" id="game-detail-cancel" type="button">Cerrar</button>
</div>
</div>
</div>

<script>
/* Bookshell BOOT: fallback de navegaci√≥n + overlay de errores (no toca tus JS) */
(() => {
  const showOverlay = (msg) => {
    try {
      let ov = document.getElementById("boot-error-overlay");
      if (!ov) {
        ov = document.createElement("div");
        ov.id = "boot-error-overlay";
        ov.style.cssText = [
          "position:fixed","inset:0","z-index:999999",
          "background:rgba(0,0,0,.92)","color:#fff",
          "padding:14px","font:12px/1.35 ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, 'Liberation Mono', monospace",
          "overflow:auto","white-space:pre-wrap"
        ].join(";");
        const head = document.createElement("div");
        head.style.cssText = "display:flex;gap:10px;align-items:center;margin-bottom:10px;";
        head.innerHTML = "<b style='font-size:13px'>‚ö†Ô∏è Error JS (BOOT)</b><span style='opacity:.75'>Toca para cerrar</span>";
        ov.appendChild(head);
        ov.addEventListener("click", () => ov.remove());
        document.body.appendChild(ov);
      }
      ov.appendChild(document.createTextNode("\n" + msg + "\n"));
      console.error(msg);
    } catch {}
  };

  window.addEventListener("error", (e) => {
    const msg = e?.error?.stack || `${e.message || "Error"} @ ${e.filename || ""}:${e.lineno || ""}:${e.colno || ""}`;
    showOverlay(msg);
  });

  window.addEventListener("unhandledrejection", (e) => {
    const r = e?.reason;
    const msg = r?.stack || (typeof r === "string" ? r : JSON.stringify(r));
    showOverlay("UnhandledPromiseRejection: " + msg);
  });

  const deepLinkParams = new URLSearchParams(location.search);
  const deepLinkDebug = deepLinkParams.has("debugDeepLink") || window.__bookshellDebugDeepLink;
  if (deepLinkDebug) window.__bookshellDebugDeepLink = true;
  const logDeepLink = (...args) => {
    if (deepLinkDebug) console.log("[BOOT][DeepLink]", ...args);
  };
  const logNav = (label, payload = {}) => {
    if (!deepLinkDebug) return;
    const stack = new Error().stack;
    console.log("[NAV]", label, payload, stack);
  };

  const setView = (viewId) => {
    const views = document.querySelectorAll(".view");
    if (!views.length) return;
    logNav("setView", { viewId, from: document.querySelector(".view.view-active")?.id || "" });
    views.forEach(v => v.classList.toggle("view-active", v.id === viewId));
    document.querySelectorAll(".bottom-nav .nav-btn").forEach(b => {
      b.classList.toggle("nav-btn-active", b.dataset.view === viewId);
      if (b.dataset.view === viewId) b.setAttribute("aria-current","page"); else b.removeAttribute("aria-current");
    });

  };
  const addLinkDeepLink = deepLinkParams.get("addLink") === "1";
  const deepLinkView = (() => {
    const explicit = deepLinkParams.get("view");
    if (explicit) return explicit;
    if (addLinkDeepLink) return "view-links-new";
    return "";
  })();

  if (addLinkDeepLink) {
    console.log("[BOOT] deep link detectado", { search: location.search, hash: location.hash });
    window.__bookshellAddLinkDeepLink = true;
    if (!location.hash) {
      try {
        logNav("replaceState addLink hash", { to: "#view-links-new" });
        history.replaceState(null, "", `${location.pathname}${location.search}#view-links-new`);
      } catch {
        logNav("location.hash addLink", { to: "#view-links-new" });
        location.hash = "#view-links-new";
      }
    }
  }

  if (deepLinkView && document.getElementById(deepLinkView)) {
    const nextHash = `#${deepLinkView}`;
    if (location.hash !== nextHash) {
      try {
        logNav("replaceState deepLinkView", { to: nextHash });
        history.replaceState(null, "", `${location.pathname}${location.search}${nextHash}`);
      } catch {}
    }
    logDeepLink("prehash set", deepLinkView);
  }


  // click fallback (captura por si tu main.js muere)
  document.addEventListener("click", (e) => {
    const btn = e.target && e.target.closest ? e.target.closest(".bottom-nav .nav-btn[data-view]") : null;
    if (!btn) return;
    e.preventDefault();
    logDeepLink("nav click fallback", btn.dataset.view);
    setView(btn.dataset.view);
  }, true);

  // expone util por consola
  window.__bookshellSetView = setView;
const applyInitialView = () => {
  const hash = (location.hash || "").replace("#", "");
  const target = hash && document.getElementById(hash) ? hash : "";
  logNav("applyInitialView", { hash, target });
  if (target) setView(target);
};

// DOM listo -> aplica vista
if (document.readyState === "loading") {
  document.addEventListener("DOMContentLoaded", applyInitialView, { once: true });
} else {
  applyInitialView();
}

  console.log("[BOOT] nav fallback listo");
})();
</script>

<script src="scripts/main.js" type="module"></script>
<script src="https://cdn.jsdelivr.net/npm/quill@1.3.7/dist/quill.min.js"></script>
<script src="scripts/videos.js" type="module"></script>
<script src="scripts/recipes.js" type="module"></script>
<script src="scripts/habits.js" type="module"></script>
<script src="scripts/games.js" type="module"></script>
<script src="scripts/dashboard.js" type="module"></script>
<script src="scripts/media.js" type="module"></script>
<script src="scripts/world.js" type="module"></script>
<script src="scripts/gym.js" type="module"></script>
<datalist id="country-options"></datalist>
</body>
</html>
